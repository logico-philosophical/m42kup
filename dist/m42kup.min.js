!function webpackUniversalModuleDefinition(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.m42kup=t():e.m42kup=t()}("undefined"!=typeof self?self:this,(function(){return function(e){var t={};function __webpack_require__(r){if(t[r])return t[r].exports;var a=t[r]={i:r,l:!1,exports:{}};return e[r].call(a.exports,a,a.exports,__webpack_require__),a.l=!0,a.exports}return __webpack_require__.m=e,__webpack_require__.c=t,__webpack_require__.d=function(e,t,r){__webpack_require__.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},__webpack_require__.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},__webpack_require__.t=function(e,t){if(1&t&&(e=__webpack_require__(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(__webpack_require__.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)__webpack_require__.d(r,a,function(t){return e[t]}.bind(null,a));return r},__webpack_require__.n=function(e){var t=e&&e.__esModule?function getDefault(){return e.default}:function getModuleExports(){return e};return __webpack_require__.d(t,"a",t),t},__webpack_require__.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},__webpack_require__.p="",__webpack_require__(__webpack_require__.s=8)}([function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=class Node{toString(){return this.toIndentedString(0)}}},function(e,t,r){"use strict";var a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=a(r(2));t.default=class ElementClass{constructor({name:e,display:t,render:r,split:a}){if(!e)throw TypeError("You give arg0 a bad name");if(!["inline","leaf-block","container-block"].includes(t))throw TypeError('arg0.display should be one of "inline", "leaf-block", or "container-block".');if(!(r instanceof Function))throw TypeError("arg0.render should be a function");if([this.name,this.display]=[e,t],this.render=(e,t)=>{if(!(e instanceof n.default))throw TypeError("arg0 should be an instance of m42kup.renderer.Element");return r(e,t)},void 0!==a){if("string"==typeof a&&(a=[a]),!(a instanceof Array))throw TypeError("arg0.split should be either undefined, a string, or an array");if(!a.length)throw TypeError("arg0.split.length == 0");this.split=a}}instantiate({code:e,attributes:t,children:r,options:a}){return new n.default({name:this.name,display:this.display,render:this.render,code:e,attributes:t,children:r,split:this.split,options:a})}}},function(e,t,r){"use strict";var a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=a(r(3)),i=a(r(4)),o=a(r(5)),l=a(r(0)),s=a(r(6));class Element extends l.default{constructor({name:e,display:t,render:r,code:a,attributes:l,children:p,split:u,options:c}){if(super(),!e)throw TypeError("You give arg0 a bad name");if(!["inline","leaf-block","container-block"].includes(t))throw TypeError('arg0.display should be one of "inline", "leaf-block", or "container-block".');if(!(r instanceof Function))throw TypeError("arg0.render should be a function");if("string"!=typeof a)throw TypeError("You give arg0 a bad code");if(!(l instanceof Array))throw TypeError("attributes should be an array");if((()=>{var foo=e=>e instanceof Element||e instanceof s.default||e instanceof n.default||e instanceof Array&&e.every(foo);if(!p.every(foo))throw TypeError("All arg0.children should either be an Element, a TextNode, or an ErrorNode")})(),void 0!==u){if("string"==typeof u&&(u=[u]),!(u instanceof Array))throw TypeError("arg0.split should be either undefined, a string, or an array");if(!u.length)throw TypeError("arg0.split.length == 0");this.split=u}var f,h;[this.name,this.display,this.code,this.attributes,this.children]=[e,t,a,l,p],this.innerIsText=(f=u?u.length:0,(h=(e,t)=>t>0?e.map((e=>h(e,t-1))):e.map((e=>e instanceof s.default||!(e instanceof n.default)&&e.outerIsText)).every((e=>e)))(p,f)),this.innerText=(()=>{var e=u?u.length:0,foo=(e,t,r)=>t>0?e.map(((e,a)=>foo(e,t-1,r[a]))):r?e.map((e=>e instanceof s.default?e.text:e.outerText)).join(""):null;return foo(p,e,this.innerIsText)})(),this.innerHtml=(()=>{var e=u?u.length:0,foo=(e,t,r,a)=>{if(t>0)return e.map(((e,n)=>foo(e,t-1,r[n],a[n])));if(r)return a.trim()&&"container-block"==this.display?a.split(/(?:\r\n[ \t]*){2,}|(?:\r[ \t]*){2,}|(?:\n[ \t]*){2,}/).filter((e=>!!e.trim())).map(i.default).map((e=>`<p>${e}</p>`)).join(""):i.default(a);if("container-block"!=this.display)return e.map((e=>e instanceof s.default?i.default(e.text):e instanceof n.default?e.toHtml():e.outerHtml)).join("");var o=[],l=[],commit=()=>{l.length&&(o.push(l),l=[])},add=e=>l.push(e);return e.forEach((e=>{if(e instanceof s.default){var t=e.text.split(/(?:\r\n[ \t]*){2,}|(?:\r[ \t]*){2,}|(?:\n[ \t]*){2,}/);if(t.length<2)return add(e);t.forEach(((e,r)=>{e.trim()&&add(this.text(e)),r<t.length-1&&commit()}))}else e instanceof n.default?add(e):"inline"!=e.display?(commit(),o.push(e),commit()):add(e)})),commit(),o.map((e=>e instanceof Array?"<p>"+e.map((e=>e instanceof s.default?i.default(e.text):e instanceof n.default?e.toHtml():e.outerHtml)).join("")+"</p>":e.outerHtml)).join("")};return foo(p,e,this.innerIsText,this.innerText)})();var d=r(this,c);if(this.outerIsText=d instanceof s.default,this.outerText=this.outerIsText?d.text:null,this.isError=d instanceof n.default,this.errorMessage=d instanceof n.default?d.message:null,this.outerIsText)this.outerHtml=i.default(this.outerText);else if(d instanceof o.default)this.outerHtml=d.html;else{if(!(d instanceof n.default))throw TypeError("Render output should be one of TextNode, HtmlNode, or ErrorNode");this.outerHtml=d.toHtml()}}text(e){return new s.default(e)}html(e){return new o.default({html:e,display:this.display})}error(e){return new n.default({message:`[${this.name}]: ${e}`,code:this.code})}getAttribute(e){for(var t=0;t<this.attributes.length;t++)if(this.attributes[t].name==e)return this.attributes[t].value;return null}toIndentedString(e){var t=["display","code","attributes","split","isError","errorMessage","innerIsText","innerText","innerHtml","outerIsText","outerText","outerHtml"].map((e=>e+"="+("string"==typeof this[e]||this[e]instanceof Array?JSON.stringify(this[e]):this[e]+""))).join("\n"+"\t".repeat(e+1)),r=function recurse(e,t){return e.map((e=>e instanceof Array?["[","\t"+recurse(e,t+1),"]"].join("\n"+"\t".repeat(t)):e.toIndentedString(t))).join(",\n"+"\t".repeat(t))}(this.children,e+1);return`Element[${JSON.stringify(this.name)}](\n${"\t".repeat(e+1)}${t}\n${"\t".repeat(e)}) {\n`+"\t".repeat(e+1)+`${r}\n`+`${"\t".repeat(e)}}`}escapeHtml(e){return i.default(e)}}t.default=Element},function(e,t,r){"use strict";var a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=a(r(4)),i=a(r(0));class ErrorNode extends i.default{constructor({message:e,code:t}){if(super(),"string"!=typeof e)throw TypeError("message not string");if("string"!=typeof t)throw TypeError("code not string");this.message=e,this.code=t}toHtml(){return`<code class="m42kup-error" title="Error: ${n.default(this.message)}">${n.default(this.code)}</code>`}toIndentedString(e){return`Error(${["message","code"].map((e=>e+"="+JSON.stringify(this[e]))).join(" ")})`}}t.default=ErrorNode},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function escapeHtml(e){return(e+"").replace(/[&<>"']/g,(e=>({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"}[e])))}},function(e,t,r){"use strict";var a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=a(r(0));class HtmlNode extends n.default{constructor({html:e,display:t}){if(super(),"string"!=typeof e)throw TypeError("html not string");if(!["inline","leaf-block","container-block"].includes(t))throw TypeError('arg0.display should be one of "inline", "leaf-block", or "container-block".');this.html=e,this.display=t}toIndentedString(e){return`Html(${["display"].map((e=>e+"="+JSON.stringify(this[e]))).join(" ")}) {${JSON.stringify(this.html)}}`}}t.default=HtmlNode},function(e,t,r){"use strict";var a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=a(r(0));class TextNode extends n.default{constructor(e){if(super(),"string"!=typeof e)throw TypeError("text not string");this.text=e}toIndentedString(e){return`Text {${JSON.stringify(this.text)}}`}}t.default=TextNode},function(e,t,r){"use strict";function shallow(e){var t={};for(var r in e)t[r]=e[r];return t}function copyOptions(e){var t={};return e.tags&&(t.tags=shallow(e.tags)),e.hljs&&(t.hljs=e.hljs),e.katex&&(t.katex=e.katex),t}function tags(e,t){for(var r in e=shallow(e),t)e[r]=t[r];return e}Object.defineProperty(t,"__esModule",{value:!0}),t.default={copyOptions:copyOptions,tags:tags,options:function options(e,t){if("object"!=typeof e||"object"!=typeof t)throw TypeError("One of the options provided is not an object");return e=copyOptions(e),t.tags&&(e.tags||(e.tags={}),e.tags=tags(e.tags,t.tags)),t.hljs&&(e.hljs=t.hljs),t.katex&&(e.katex=t.katex),e}}},function(e,t,r){"use strict";var a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=a(r(9)),i=a(r(11)),o=a(r(13)),l=a(r(7)),s=a(r(14));var p={};var u={parser:n.default,renderer:i.default,highlighter:o.default,ast2nt:function ast2nt(e,t){return t||(t={}),t.tags||(t.tags={}),t=l.default.options(p,t),i.default.ast2nt(e,t)},render:function render(e,t){e+="",t||(t={}),t.tags||(t.tags={}),t=l.default.options(p,t);var r=n.default.input2pt(e),a=n.default.pt2ast(r);return i.default.ast2nt(a,t).outerHtml},highlight:function highlight(e){e+="";var t=n.default.input2pt(e);return o.default.pt2hl(t)},cascade:function cascadeOptions(e){if("object"!=typeof e)throw TypeError("typeof options != 'object'");p=l.default.options(p,e)},set:function setOptions(e){if("object"!=typeof e)throw TypeError("typeof options != 'object'");p=e},addCodeMirrorMode:s.default};e.exports=u},function(e,t,r){"use strict";var a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=a(r(10));t.default={input2pt:function input2pt(e){var t=n.default.parse(e);return t.input=e,t},pt2ast:function pt2ast(e){var t=e.input,r=function recurse(e){var r=e.map((e=>{switch(e.type){case"text":return{type:"text",text:e.text};case"verbatim":return{type:"text",text:e.child.text};case"element":var r="parenthesis"!=e.attributes._type?[]:e.attributes.content.filter((({_type:e})=>"attribute"==e)).map((({attribute:e})=>({name:e[0],value:e[3]})));return{type:"element",name:e.name,attributes:r,code:t.substring(e.location.start.offset,e.location.end.offset),children:recurse(e.children)};default:throw new TypeError(`Unknown type: ${e.type}`)}}));return r=r.reduce(((e,t)=>{if("text"==t.type){if(!t.text)return e;if(e.length&&"text"==e[e.length-1].type)return e[e.length-1].text+=t.text,e}return e.push(t),e}),[])}(e.root.children);return{input:e.input,root:{type:"root",children:r,code:t}}}}},function(e,t,r){"use strict";function peg$SyntaxError(e,t,r,a){this.message=e,this.expected=t,this.found=r,this.location=a,this.name="SyntaxError","function"==typeof Error.captureStackTrace&&Error.captureStackTrace(this,peg$SyntaxError)}!function peg$subclass(e,t){function ctor(){this.constructor=e}ctor.prototype=t.prototype,e.prototype=new ctor}(peg$SyntaxError,Error),peg$SyntaxError.buildMessage=function(e,t){var r={literal:function(e){return'"'+literalEscape(e.text)+'"'},class:function(e){var t,r="";for(t=0;t<e.parts.length;t++)r+=e.parts[t]instanceof Array?classEscape(e.parts[t][0])+"-"+classEscape(e.parts[t][1]):classEscape(e.parts[t]);return"["+(e.inverted?"^":"")+r+"]"},any:function(e){return"any character"},end:function(e){return"end of input"},other:function(e){return e.description}};function hex(e){return e.charCodeAt(0).toString(16).toUpperCase()}function literalEscape(e){return e.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(function(e){return"\\x0"+hex(e)})).replace(/[\x10-\x1F\x7F-\x9F]/g,(function(e){return"\\x"+hex(e)}))}function classEscape(e){return e.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(function(e){return"\\x0"+hex(e)})).replace(/[\x10-\x1F\x7F-\x9F]/g,(function(e){return"\\x"+hex(e)}))}return"Expected "+function describeExpected(e){var t,a,n,i=new Array(e.length);for(t=0;t<e.length;t++)i[t]=(n=e[t],r[n.type](n));if(i.sort(),i.length>0){for(t=1,a=1;t<i.length;t++)i[t-1]!==i[t]&&(i[a]=i[t],a++);i.length=a}switch(i.length){case 1:return i[0];case 2:return i[0]+" or "+i[1];default:return i.slice(0,-1).join(", ")+", or "+i[i.length-1]}}(e)+" but "+function describeFound(e){return e?'"'+literalEscape(e)+'"':"end of input"}(t)+" found."},e.exports={SyntaxError:peg$SyntaxError,parse:function peg$parse(e,t){t=void 0!==t?t:{};var r,a={},n={start:peg$parsestart},i=peg$parsestart,o=peg$literalExpectation("[",!1),l="<",s=peg$literalExpectation("<",!1),p="!",u=peg$literalExpectation("!",!1),c='"',f=peg$literalExpectation('"',!1),h="#",d=peg$literalExpectation("#",!1),g="$",m=peg$literalExpectation("$",!1),$="%",y=peg$literalExpectation("%",!1),b="&",x=peg$literalExpectation("&",!1),v="'",_=peg$literalExpectation("'",!1),A=")",E=peg$literalExpectation(")",!1),k="*",C=peg$literalExpectation("*",!1),w="+",T=peg$literalExpectation("+",!1),j=",",H=peg$literalExpectation(",",!1),O="-",M=peg$literalExpectation("-",!1),q="/",S=peg$literalExpectation("/",!1),N=";",I=peg$literalExpectation(";",!1),P="=",z=peg$literalExpectation("=",!1),F=">",U=peg$literalExpectation(">",!1),D="?",R=peg$literalExpectation("?",!1),L="@",J=peg$literalExpectation("@",!1),Y="\\",B=peg$literalExpectation("\\",!1),G="^",K=peg$literalExpectation("^",!1),Q="_",V=peg$literalExpectation("_",!1),W="{",X=peg$literalExpectation("{",!1),Z="|",ee=peg$literalExpectation("|",!1),te="}",re=peg$literalExpectation("}",!1),ae="~",ne=peg$literalExpectation("~",!1),ie=/^[a-z]/,oe=peg$classExpectation([["a","z"]],!1,!1),le=/^[a-z0-9]/,se=peg$classExpectation([["a","z"],["0","9"]],!1,!1),pe=":",ue=peg$literalExpectation(":",!1),peg$c65=function(e,t,r,a){return":"+r+a.join("")},ce="",fe=peg$literalExpectation("(",!1),he=/^[a-z0-9\-]/,de=peg$classExpectation([["a","z"],["0","9"],"-"],!1,!1),ge={type:"any"},peg$c74=function(e,t,r,a,n,i){return[r,a,n,i]},me=/^['"()[\] \t\n\r]/,$e=peg$classExpectation(["'",'"',"(",")","[","]"," ","\t","\n","\r"],!1,!1),peg$c77=function(e,t,r,a){return[r,"",a,""]},peg$c79=function(e,t,r){return{_type:"attribute",attribute:[t].concat(r)}},peg$c80=function(e,t){return{_type:"whitespace",whitespace:t}},peg$c81=function(e,t){return{_type:"error",error:t}},ye=".",be=peg$literalExpectation(".",!1),xe=peg$literalExpectation("]",!1),ve="`",_e=peg$literalExpectation("`",!1),peg$c96=function(e){return{type:"text",text:e.join(""),location:location()}},Ae=/^[ \t\n\r]/,Ee=peg$classExpectation([" ","\t","\n","\r"],!1,!1),ke=0,Ce=0,we=[{line:1,column:1}],Te=0,je=[],He=0;if("startRule"in t){if(!(t.startRule in n))throw new Error("Can't start parsing from rule \""+t.startRule+'".');i=n[t.startRule]}function location(){return peg$computeLocation(Ce,ke)}function peg$literalExpectation(e,t){return{type:"literal",text:e,ignoreCase:t}}function peg$classExpectation(e,t,r){return{type:"class",parts:e,inverted:t,ignoreCase:r}}function peg$computePosDetails(t){var r,a=we[t];if(a)return a;for(r=t-1;!we[r];)r--;for(a={line:(a=we[r]).line,column:a.column};r<t;)10===e.charCodeAt(r)?(a.line++,a.column=1):a.column++,r++;return we[t]=a,a}function peg$computeLocation(e,t){var r=peg$computePosDetails(e),a=peg$computePosDetails(t);return{start:{offset:e,line:r.line,column:r.column},end:{offset:t,line:a.line,column:a.column}}}function peg$fail(e){ke<Te||(ke>Te&&(Te=ke,je=[]),je.push(e))}function peg$buildStructuredError(e,t,r){return new peg$SyntaxError(peg$SyntaxError.buildMessage(e,t),e,t,r)}function peg$parsestart(){var e,t;return e=ke,(t=peg$parsethings())!==a&&(Ce=e,t={root:{type:"root",children:t,location:location()}}),e=t}function peg$parsethings(){var e,t;for(e=[],t=peg$parsething();t!==a;)e.push(t),t=peg$parsething();return e}function peg$parsething(){var t;return(t=function peg$parseelement(){var t,r,n,i,o,l;t=ke,(r=function peg$parselbm_push(){var e,t;e=ke,(t=peg$parselbm())!==a&&(Ce=e,r=t,Me.push(r.length),t=r);var r;return e=t}())!==a&&(n=function peg$parsetag_name(){var t,r,n,i,o,l,s,fe,he,de;t=ke,r=[],33===e.charCodeAt(ke)?(n=p,ke++):(n=a,0===He&&peg$fail(u));if(n!==a)for(;n!==a;)r.push(n),33===e.charCodeAt(ke)?(n=p,ke++):(n=a,0===He&&peg$fail(u));else r=a;if(r===a){if(r=[],34===e.charCodeAt(ke)?(n=c,ke++):(n=a,0===He&&peg$fail(f)),n!==a)for(;n!==a;)r.push(n),34===e.charCodeAt(ke)?(n=c,ke++):(n=a,0===He&&peg$fail(f));else r=a;if(r===a){if(r=[],35===e.charCodeAt(ke)?(n=h,ke++):(n=a,0===He&&peg$fail(d)),n!==a)for(;n!==a;)r.push(n),35===e.charCodeAt(ke)?(n=h,ke++):(n=a,0===He&&peg$fail(d));else r=a;if(r===a){if(r=[],36===e.charCodeAt(ke)?(n=g,ke++):(n=a,0===He&&peg$fail(m)),n!==a)for(;n!==a;)r.push(n),36===e.charCodeAt(ke)?(n=g,ke++):(n=a,0===He&&peg$fail(m));else r=a;if(r===a){if(r=[],37===e.charCodeAt(ke)?(n=$,ke++):(n=a,0===He&&peg$fail(y)),n!==a)for(;n!==a;)r.push(n),37===e.charCodeAt(ke)?(n=$,ke++):(n=a,0===He&&peg$fail(y));else r=a;if(r===a){if(r=[],38===e.charCodeAt(ke)?(n=b,ke++):(n=a,0===He&&peg$fail(x)),n!==a)for(;n!==a;)r.push(n),38===e.charCodeAt(ke)?(n=b,ke++):(n=a,0===He&&peg$fail(x));else r=a;if(r===a){if(r=[],39===e.charCodeAt(ke)?(n=v,ke++):(n=a,0===He&&peg$fail(_)),n!==a)for(;n!==a;)r.push(n),39===e.charCodeAt(ke)?(n=v,ke++):(n=a,0===He&&peg$fail(_));else r=a;if(r===a){if(r=[],41===e.charCodeAt(ke)?(n=A,ke++):(n=a,0===He&&peg$fail(E)),n!==a)for(;n!==a;)r.push(n),41===e.charCodeAt(ke)?(n=A,ke++):(n=a,0===He&&peg$fail(E));else r=a;if(r===a){if(r=[],42===e.charCodeAt(ke)?(n=k,ke++):(n=a,0===He&&peg$fail(C)),n!==a)for(;n!==a;)r.push(n),42===e.charCodeAt(ke)?(n=k,ke++):(n=a,0===He&&peg$fail(C));else r=a;if(r===a){if(r=[],43===e.charCodeAt(ke)?(n=w,ke++):(n=a,0===He&&peg$fail(T)),n!==a)for(;n!==a;)r.push(n),43===e.charCodeAt(ke)?(n=w,ke++):(n=a,0===He&&peg$fail(T));else r=a;if(r===a){if(r=[],44===e.charCodeAt(ke)?(n=j,ke++):(n=a,0===He&&peg$fail(H)),n!==a)for(;n!==a;)r.push(n),44===e.charCodeAt(ke)?(n=j,ke++):(n=a,0===He&&peg$fail(H));else r=a;if(r===a){if(r=[],45===e.charCodeAt(ke)?(n=O,ke++):(n=a,0===He&&peg$fail(M)),n!==a)for(;n!==a;)r.push(n),45===e.charCodeAt(ke)?(n=O,ke++):(n=a,0===He&&peg$fail(M));else r=a;if(r===a){if(r=[],47===e.charCodeAt(ke)?(n=q,ke++):(n=a,0===He&&peg$fail(S)),n!==a)for(;n!==a;)r.push(n),47===e.charCodeAt(ke)?(n=q,ke++):(n=a,0===He&&peg$fail(S));else r=a;if(r===a){if(r=[],59===e.charCodeAt(ke)?(n=N,ke++):(n=a,0===He&&peg$fail(I)),n!==a)for(;n!==a;)r.push(n),59===e.charCodeAt(ke)?(n=N,ke++):(n=a,0===He&&peg$fail(I));else r=a;if(r===a){if(r=[],61===e.charCodeAt(ke)?(n=P,ke++):(n=a,0===He&&peg$fail(z)),n!==a)for(;n!==a;)r.push(n),61===e.charCodeAt(ke)?(n=P,ke++):(n=a,0===He&&peg$fail(z));else r=a;if(r===a){if(r=[],62===e.charCodeAt(ke)?(n=F,ke++):(n=a,0===He&&peg$fail(U)),n!==a)for(;n!==a;)r.push(n),62===e.charCodeAt(ke)?(n=F,ke++):(n=a,0===He&&peg$fail(U));else r=a;if(r===a){if(r=[],63===e.charCodeAt(ke)?(n=D,ke++):(n=a,0===He&&peg$fail(R)),n!==a)for(;n!==a;)r.push(n),63===e.charCodeAt(ke)?(n=D,ke++):(n=a,0===He&&peg$fail(R));else r=a;if(r===a){if(r=[],64===e.charCodeAt(ke)?(n=L,ke++):(n=a,0===He&&peg$fail(J)),n!==a)for(;n!==a;)r.push(n),64===e.charCodeAt(ke)?(n=L,ke++):(n=a,0===He&&peg$fail(J));else r=a;if(r===a){if(r=[],92===e.charCodeAt(ke)?(n=Y,ke++):(n=a,0===He&&peg$fail(B)),n!==a)for(;n!==a;)r.push(n),92===e.charCodeAt(ke)?(n=Y,ke++):(n=a,0===He&&peg$fail(B));else r=a;if(r===a){if(r=[],94===e.charCodeAt(ke)?(n=G,ke++):(n=a,0===He&&peg$fail(K)),n!==a)for(;n!==a;)r.push(n),94===e.charCodeAt(ke)?(n=G,ke++):(n=a,0===He&&peg$fail(K));else r=a;if(r===a){if(r=[],95===e.charCodeAt(ke)?(n=Q,ke++):(n=a,0===He&&peg$fail(V)),n!==a)for(;n!==a;)r.push(n),95===e.charCodeAt(ke)?(n=Q,ke++):(n=a,0===He&&peg$fail(V));else r=a;if(r===a){if(r=[],123===e.charCodeAt(ke)?(n=W,ke++):(n=a,0===He&&peg$fail(X)),n!==a)for(;n!==a;)r.push(n),123===e.charCodeAt(ke)?(n=W,ke++):(n=a,0===He&&peg$fail(X));else r=a;if(r===a){if(r=[],124===e.charCodeAt(ke)?(n=Z,ke++):(n=a,0===He&&peg$fail(ee)),n!==a)for(;n!==a;)r.push(n),124===e.charCodeAt(ke)?(n=Z,ke++):(n=a,0===He&&peg$fail(ee));else r=a;if(r===a){if(r=[],125===e.charCodeAt(ke)?(n=te,ke++):(n=a,0===He&&peg$fail(re)),n!==a)for(;n!==a;)r.push(n),125===e.charCodeAt(ke)?(n=te,ke++):(n=a,0===He&&peg$fail(re));else r=a;if(r===a)if(r=[],126===e.charCodeAt(ke)?(n=ae,ke++):(n=a,0===He&&peg$fail(ne)),n!==a)for(;n!==a;)r.push(n),126===e.charCodeAt(ke)?(n=ae,ke++):(n=a,0===He&&peg$fail(ne));else r=a}}}}}}}}}}}}}}}}}}}}}}}t=r!==a?e.substring(t,ke):r;if(t===a){if(t=ke,ie.test(e.charAt(ke))?(r=e.charAt(ke),ke++):(r=a,0===He&&peg$fail(oe)),r!==a){for(n=ke,i=[],le.test(e.charAt(ke))?(o=e.charAt(ke),ke++):(o=a,0===He&&peg$fail(se));o!==a;)i.push(o),le.test(e.charAt(ke))?(o=e.charAt(ke),ke++):(o=a,0===He&&peg$fail(se));if((n=i!==a?e.substring(n,ke):i)!==a){if(i=ke,o=[],l=ke,58===e.charCodeAt(ke)?(s=pe,ke++):(s=a,0===He&&peg$fail(ue)),s!==a)if(ie.test(e.charAt(ke))?(fe=e.charAt(ke),ke++):(fe=a,0===He&&peg$fail(oe)),fe!==a){for(he=[],le.test(e.charAt(ke))?(de=e.charAt(ke),ke++):(de=a,0===He&&peg$fail(se));de!==a;)he.push(de),le.test(e.charAt(ke))?(de=e.charAt(ke),ke++):(de=a,0===He&&peg$fail(se));he!==a?(Ce=l,l=s=peg$c65(0,0,fe,he)):(ke=l,l=a)}else ke=l,l=a;else ke=l,l=a;for(;l!==a;)if(o.push(l),l=ke,58===e.charCodeAt(ke)?(s=pe,ke++):(s=a,0===He&&peg$fail(ue)),s!==a)if(ie.test(e.charAt(ke))?(fe=e.charAt(ke),ke++):(fe=a,0===He&&peg$fail(oe)),fe!==a){for(he=[],le.test(e.charAt(ke))?(de=e.charAt(ke),ke++):(de=a,0===He&&peg$fail(se));de!==a;)he.push(de),le.test(e.charAt(ke))?(de=e.charAt(ke),ke++):(de=a,0===He&&peg$fail(se));he!==a?(Ce=l,l=s=peg$c65(0,0,fe,he)):(ke=l,l=a)}else ke=l,l=a;else ke=l,l=a;(i=o!==a?e.substring(i,ke):o)!==a?(Ce=t,t=r=r+n+i):(ke=t,t=a)}else ke=t,t=a}else ke=t,t=a;t===a&&(t=ce)}return t}())!==a&&(i=function peg$parseattributes(){var t,r,n,i,o,l,s,p,u,h,d,g,m;t=ke,40===e.charCodeAt(ke)?(r="(",ke++):(r=a,0===He&&peg$fail(fe));if(r!==a){if(n=[],i=ke,o=ke,l=[],he.test(e.charAt(ke))?(s=e.charAt(ke),ke++):(s=a,0===He&&peg$fail(de)),s!==a)for(;s!==a;)l.push(s),he.test(e.charAt(ke))?(s=e.charAt(ke),ke++):(s=a,0===He&&peg$fail(de));else l=a;if((o=l!==a?e.substring(o,ke):l)!==a){if(l=ke,61===e.charCodeAt(ke)?(s=P,ke++):(s=a,0===He&&peg$fail(z)),s!==a)if(34===e.charCodeAt(ke)?(p=c,ke++):(p=a,0===He&&peg$fail(f)),p!==a){for(u=ke,h=[],d=ke,g=ke,He++,34===e.charCodeAt(ke)?(m=c,ke++):(m=a,0===He&&peg$fail(f)),He--,m===a?g=void 0:(ke=g,g=a),g!==a?(e.length>ke?(m=e.charAt(ke),ke++):(m=a,0===He&&peg$fail(ge)),m!==a?d=g=[g,m]:(ke=d,d=a)):(ke=d,d=a);d!==a;)h.push(d),d=ke,g=ke,He++,34===e.charCodeAt(ke)?(m=c,ke++):(m=a,0===He&&peg$fail(f)),He--,m===a?g=void 0:(ke=g,g=a),g!==a?(e.length>ke?(m=e.charAt(ke),ke++):(m=a,0===He&&peg$fail(ge)),m!==a?d=g=[g,m]:(ke=d,d=a)):(ke=d,d=a);(u=h!==a?e.substring(u,ke):h)!==a?(34===e.charCodeAt(ke)?(h=c,ke++):(h=a,0===He&&peg$fail(f)),h===a&&(h=ke,(d=peg$parseEOF())!==a&&(Ce=h,d=""),h=d),h!==a?(Ce=l,l=s=peg$c74(0,0,s,p,u,h)):(ke=l,l=a)):(ke=l,l=a)}else ke=l,l=a;else ke=l,l=a;if(l===a){if(l=ke,61===e.charCodeAt(ke)?(s=P,ke++):(s=a,0===He&&peg$fail(z)),s!==a)if(39===e.charCodeAt(ke)?(p=v,ke++):(p=a,0===He&&peg$fail(_)),p!==a){for(u=ke,h=[],d=ke,g=ke,He++,39===e.charCodeAt(ke)?(m=v,ke++):(m=a,0===He&&peg$fail(_)),He--,m===a?g=void 0:(ke=g,g=a),g!==a?(e.length>ke?(m=e.charAt(ke),ke++):(m=a,0===He&&peg$fail(ge)),m!==a?d=g=[g,m]:(ke=d,d=a)):(ke=d,d=a);d!==a;)h.push(d),d=ke,g=ke,He++,39===e.charCodeAt(ke)?(m=v,ke++):(m=a,0===He&&peg$fail(_)),He--,m===a?g=void 0:(ke=g,g=a),g!==a?(e.length>ke?(m=e.charAt(ke),ke++):(m=a,0===He&&peg$fail(ge)),m!==a?d=g=[g,m]:(ke=d,d=a)):(ke=d,d=a);(u=h!==a?e.substring(u,ke):h)!==a?(39===e.charCodeAt(ke)?(h=v,ke++):(h=a,0===He&&peg$fail(_)),h===a&&(h=ke,(d=peg$parseEOF())!==a&&(Ce=h,d=""),h=d),h!==a?(Ce=l,l=s=peg$c74(0,0,s,p,u,h)):(ke=l,l=a)):(ke=l,l=a)}else ke=l,l=a;else ke=l,l=a;if(l===a){if(l=ke,61===e.charCodeAt(ke)?(s=P,ke++):(s=a,0===He&&peg$fail(z)),s!==a){for(p=ke,u=[],h=ke,d=ke,He++,me.test(e.charAt(ke))?(g=e.charAt(ke),ke++):(g=a,0===He&&peg$fail($e)),He--,g===a?d=void 0:(ke=d,d=a),d!==a?(e.length>ke?(g=e.charAt(ke),ke++):(g=a,0===He&&peg$fail(ge)),g!==a?h=d=[d,g]:(ke=h,h=a)):(ke=h,h=a);h!==a;)u.push(h),h=ke,d=ke,He++,me.test(e.charAt(ke))?(g=e.charAt(ke),ke++):(g=a,0===He&&peg$fail($e)),He--,g===a?d=void 0:(ke=d,d=a),d!==a?(e.length>ke?(g=e.charAt(ke),ke++):(g=a,0===He&&peg$fail(ge)),g!==a?h=d=[d,g]:(ke=h,h=a)):(ke=h,h=a);(p=u!==a?e.substring(p,ke):u)!==a?(Ce=l,l=s=peg$c77(0,0,s,p)):(ke=l,l=a)}else ke=l,l=a;l===a&&(l=ke,(s=ce)!==a&&(Ce=l,s=["","","",""]),l=s)}}l!==a?(Ce=i,i=o=peg$c79(0,o,l)):(ke=i,i=a)}else ke=i,i=a;for(i===a&&(i=ke,(o=peg$parse__())!==a&&(Ce=i,o=peg$c80(0,o)),(i=o)===a&&(i=ke,o=ke,l=ke,s=ke,He++,41===e.charCodeAt(ke)?(p=A,ke++):(p=a,0===He&&peg$fail(E)),He--,p===a?s=void 0:(ke=s,s=a),s!==a?(p=ke,He++,u=peg$parserbm(),He--,u===a?p=void 0:(ke=p,p=a),p!==a?(e.length>ke?(u=e.charAt(ke),ke++):(u=a,0===He&&peg$fail(ge)),u!==a?l=s=[s,p,u]:(ke=l,l=a)):(ke=l,l=a)):(ke=l,l=a),(o=l!==a?e.substring(o,ke):l)!==a&&(Ce=i,o=peg$c81(0,o)),i=o));i!==a;){if(n.push(i),i=ke,o=ke,l=[],he.test(e.charAt(ke))?(s=e.charAt(ke),ke++):(s=a,0===He&&peg$fail(de)),s!==a)for(;s!==a;)l.push(s),he.test(e.charAt(ke))?(s=e.charAt(ke),ke++):(s=a,0===He&&peg$fail(de));else l=a;if((o=l!==a?e.substring(o,ke):l)!==a){if(l=ke,61===e.charCodeAt(ke)?(s=P,ke++):(s=a,0===He&&peg$fail(z)),s!==a)if(34===e.charCodeAt(ke)?(p=c,ke++):(p=a,0===He&&peg$fail(f)),p!==a){for(u=ke,h=[],d=ke,g=ke,He++,34===e.charCodeAt(ke)?(m=c,ke++):(m=a,0===He&&peg$fail(f)),He--,m===a?g=void 0:(ke=g,g=a),g!==a?(e.length>ke?(m=e.charAt(ke),ke++):(m=a,0===He&&peg$fail(ge)),m!==a?d=g=[g,m]:(ke=d,d=a)):(ke=d,d=a);d!==a;)h.push(d),d=ke,g=ke,He++,34===e.charCodeAt(ke)?(m=c,ke++):(m=a,0===He&&peg$fail(f)),He--,m===a?g=void 0:(ke=g,g=a),g!==a?(e.length>ke?(m=e.charAt(ke),ke++):(m=a,0===He&&peg$fail(ge)),m!==a?d=g=[g,m]:(ke=d,d=a)):(ke=d,d=a);(u=h!==a?e.substring(u,ke):h)!==a?(34===e.charCodeAt(ke)?(h=c,ke++):(h=a,0===He&&peg$fail(f)),h===a&&(h=ke,(d=peg$parseEOF())!==a&&(Ce=h,d=""),h=d),h!==a?(Ce=l,l=s=peg$c74(0,0,s,p,u,h)):(ke=l,l=a)):(ke=l,l=a)}else ke=l,l=a;else ke=l,l=a;if(l===a){if(l=ke,61===e.charCodeAt(ke)?(s=P,ke++):(s=a,0===He&&peg$fail(z)),s!==a)if(39===e.charCodeAt(ke)?(p=v,ke++):(p=a,0===He&&peg$fail(_)),p!==a){for(u=ke,h=[],d=ke,g=ke,He++,39===e.charCodeAt(ke)?(m=v,ke++):(m=a,0===He&&peg$fail(_)),He--,m===a?g=void 0:(ke=g,g=a),g!==a?(e.length>ke?(m=e.charAt(ke),ke++):(m=a,0===He&&peg$fail(ge)),m!==a?d=g=[g,m]:(ke=d,d=a)):(ke=d,d=a);d!==a;)h.push(d),d=ke,g=ke,He++,39===e.charCodeAt(ke)?(m=v,ke++):(m=a,0===He&&peg$fail(_)),He--,m===a?g=void 0:(ke=g,g=a),g!==a?(e.length>ke?(m=e.charAt(ke),ke++):(m=a,0===He&&peg$fail(ge)),m!==a?d=g=[g,m]:(ke=d,d=a)):(ke=d,d=a);(u=h!==a?e.substring(u,ke):h)!==a?(39===e.charCodeAt(ke)?(h=v,ke++):(h=a,0===He&&peg$fail(_)),h===a&&(h=ke,(d=peg$parseEOF())!==a&&(Ce=h,d=""),h=d),h!==a?(Ce=l,l=s=peg$c74(0,0,s,p,u,h)):(ke=l,l=a)):(ke=l,l=a)}else ke=l,l=a;else ke=l,l=a;if(l===a){if(l=ke,61===e.charCodeAt(ke)?(s=P,ke++):(s=a,0===He&&peg$fail(z)),s!==a){for(p=ke,u=[],h=ke,d=ke,He++,me.test(e.charAt(ke))?(g=e.charAt(ke),ke++):(g=a,0===He&&peg$fail($e)),He--,g===a?d=void 0:(ke=d,d=a),d!==a?(e.length>ke?(g=e.charAt(ke),ke++):(g=a,0===He&&peg$fail(ge)),g!==a?h=d=[d,g]:(ke=h,h=a)):(ke=h,h=a);h!==a;)u.push(h),h=ke,d=ke,He++,me.test(e.charAt(ke))?(g=e.charAt(ke),ke++):(g=a,0===He&&peg$fail($e)),He--,g===a?d=void 0:(ke=d,d=a),d!==a?(e.length>ke?(g=e.charAt(ke),ke++):(g=a,0===He&&peg$fail(ge)),g!==a?h=d=[d,g]:(ke=h,h=a)):(ke=h,h=a);(p=u!==a?e.substring(p,ke):u)!==a?(Ce=l,l=s=peg$c77(0,0,s,p)):(ke=l,l=a)}else ke=l,l=a;l===a&&(l=ke,(s=ce)!==a&&(Ce=l,s=["","","",""]),l=s)}}l!==a?(Ce=i,i=o=peg$c79(0,o,l)):(ke=i,i=a)}else ke=i,i=a;i===a&&(i=ke,(o=peg$parse__())!==a&&(Ce=i,o=peg$c80(0,o)),(i=o)===a&&(i=ke,o=ke,l=ke,s=ke,He++,41===e.charCodeAt(ke)?(p=A,ke++):(p=a,0===He&&peg$fail(E)),He--,p===a?s=void 0:(ke=s,s=a),s!==a?(p=ke,He++,u=peg$parserbm(),He--,u===a?p=void 0:(ke=p,p=a),p!==a?(e.length>ke?(u=e.charAt(ke),ke++):(u=a,0===He&&peg$fail(ge)),u!==a?l=s=[s,p,u]:(ke=l,l=a)):(ke=l,l=a)):(ke=l,l=a),(o=l!==a?e.substring(o,ke):l)!==a&&(Ce=i,o=peg$c81(0,o)),i=o))}n!==a?(41===e.charCodeAt(ke)?(i=A,ke++):(i=a,0===He&&peg$fail(E)),i===a&&(i=ke,o=ke,He++,l=peg$parserbm(),He--,l!==a?(ke=o,o=void 0):o=a,o!==a&&(Ce=i,o=""),i=o),i!==a?(Ce=t,t=r={_type:"parenthesis",left:r,content:n,right:i}):(ke=t,t=a)):(ke=t,t=a)}else ke=t,t=a;t===a&&(t=ke,46===e.charCodeAt(ke)?(r=".",ke++):(r=a,0===He&&peg$fail(be)),r===a&&(r=ce),r!==a&&(Ce=t,r={_type:"separator",separator:r}),t=r);return t}())!==a&&(o=peg$parsethings())!==a&&(l=function peg$parserbm_pop(){var e,t;e=ke,(t=peg$parserbm())!==a&&(Ce=e,r=t,Me.pop(),t=r);var r;return e=t}())!==a?(Ce=t,t=r={type:"element",lbm:r,name:n,attributes:i,children:o,rbm:l,location:location()}):(ke=t,t=a);return t}())===a&&(t=function peg$parseverbatim(){var t,r,n,i,o;t=ke,(r=function peg$parselvm(){var t,r,n,i;t=ke,96===e.charCodeAt(ke)?(r=ve,ke++):(r=a,0===He&&peg$fail(_e));if(r!==a){for(n=[],60===e.charCodeAt(ke)?(i=l,ke++):(i=a,0===He&&peg$fail(s));i!==a;)n.push(i),60===e.charCodeAt(ke)?(i=l,ke++):(i=a,0===He&&peg$fail(s));n!==a?(Ce=t,o=r,Oe=(p=n).length+1,t=r=o+p.join("")):(ke=t,t=a)}else ke=t,t=a;var o,p;return t}())!==a&&(n=function peg$parseverbatim_separator(){var t;46===e.charCodeAt(ke)?(t=ye,ke++):(t=a,0===He&&peg$fail(be));t===a&&(t=ce);return t}())!==a&&(i=function peg$parseverbatim_text(){var t,r,n,i,o;t=ke,r=[],n=ke,i=ke,He++,o=peg$parservm(),He--,o===a?i=void 0:(ke=i,i=a);i!==a?(e.length>ke?(o=e.charAt(ke),ke++):(o=a,0===He&&peg$fail(ge)),o!==a?(Ce=n,n=i=o):(ke=n,n=a)):(ke=n,n=a);for(;n!==a;)r.push(n),n=ke,i=ke,He++,o=peg$parservm(),He--,o===a?i=void 0:(ke=i,i=a),i!==a?(e.length>ke?(o=e.charAt(ke),ke++):(o=a,0===He&&peg$fail(ge)),o!==a?(Ce=n,n=i=o):(ke=n,n=a)):(ke=n,n=a);r!==a&&(Ce=t,r=peg$c96(r));return t=r}())!==a&&(o=peg$parservm())!==a?(Ce=t,t=r={type:"verbatim",lvm:r,separator:n,child:i,rvm:o,location:location()}):(ke=t,t=a);return t}())===a&&(t=function peg$parsetext(){var t,r,n,i,o,l,s;t=ke,r=[],n=ke,i=ke,He++,o=peg$parselbm(),He--,o===a?i=void 0:(ke=i,i=a);i!==a?(o=ke,He++,l=peg$parserbm(),He--,l===a?o=void 0:(ke=o,o=a),o!==a?(l=ke,He++,96===e.charCodeAt(ke)?(s=ve,ke++):(s=a,0===He&&peg$fail(_e)),He--,s===a?l=void 0:(ke=l,l=a),l!==a?(e.length>ke?(s=e.charAt(ke),ke++):(s=a,0===He&&peg$fail(ge)),s!==a?(Ce=n,n=i=s):(ke=n,n=a)):(ke=n,n=a)):(ke=n,n=a)):(ke=n,n=a);if(n!==a)for(;n!==a;)r.push(n),n=ke,i=ke,He++,o=peg$parselbm(),He--,o===a?i=void 0:(ke=i,i=a),i!==a?(o=ke,He++,l=peg$parserbm(),He--,l===a?o=void 0:(ke=o,o=a),o!==a?(l=ke,He++,96===e.charCodeAt(ke)?(s=ve,ke++):(s=a,0===He&&peg$fail(_e)),He--,s===a?l=void 0:(ke=l,l=a),l!==a?(e.length>ke?(s=e.charAt(ke),ke++):(s=a,0===He&&peg$fail(ge)),s!==a?(Ce=n,n=i=s):(ke=n,n=a)):(ke=n,n=a)):(ke=n,n=a)):(ke=n,n=a);else r=a;r!==a&&(Ce=t,r=peg$c96(r));return t=r}()),t}function peg$parselbm(){var t,r,n,i,p,u;if(t=ke,91===e.charCodeAt(ke)?(r="[",ke++):(r=a,0===He&&peg$fail(o)),r!==a){for(n=ke,i=[],60===e.charCodeAt(ke)?(p=l,ke++):(p=a,0===He&&peg$fail(s));p!==a;)i.push(p),60===e.charCodeAt(ke)?(p=l,ke++):(p=a,0===He&&peg$fail(s));(n=i!==a?e.substring(n,ke):i)!==a?(Ce=ke,u=n,(i=(i=(Me[Me.length-1]||0)<=u.length+1)?void 0:a)!==a?(Ce=t,t=r=function(e,t){return e+t}(r,n)):(ke=t,t=a)):(ke=t,t=a)}else ke=t,t=a;return t}function peg$parserbm(){var t,r,n,i,o;for(t=ke,r=ke,n=[],62===e.charCodeAt(ke)?(i=F,ke++):(i=a,0===He&&peg$fail(U));i!==a;)n.push(i),62===e.charCodeAt(ke)?(i=F,ke++):(i=a,0===He&&peg$fail(U));return(r=n!==a?e.substring(r,ke):n)!==a?(93===e.charCodeAt(ke)?(n="]",ke++):(n=a,0===He&&peg$fail(xe)),n!==a?(Ce=ke,o=r,(i=(i=(Me[Me.length-1]||0)==o.length+1)?void 0:a)!==a?(Ce=t,t=r=function(e,t){return e+t}(r,n)):(ke=t,t=a)):(ke=t,t=a)):(ke=t,t=a),t===a&&(t=ke,(r=peg$parseEOF())!==a&&(Ce=t,r=""),t=r),t}function peg$parseEOF(){var t,r;return t=ke,He++,e.length>ke?(r=e.charAt(ke),ke++):(r=a,0===He&&peg$fail(ge)),He--,r===a?t=void 0:(ke=t,t=a),t}function peg$parservm(){var t,r,n;for(t=ke,r=[],62===e.charCodeAt(ke)?(n=F,ke++):(n=a,0===He&&peg$fail(U));n!==a;)r.push(n),62===e.charCodeAt(ke)?(n=F,ke++):(n=a,0===He&&peg$fail(U));return r!==a?(96===e.charCodeAt(ke)?(n=ve,ke++):(n=a,0===He&&peg$fail(_e)),n!==a?(Ce=ke,(Oe==r.length+1?void 0:a)!==a?(Ce=t,t=r=function(e,t){return e.join("")+t}(r,n)):(ke=t,t=a)):(ke=t,t=a)):(ke=t,t=a),t===a&&(t=ke,(r=peg$parseEOF())!==a&&(Ce=t,r=""),t=r),t}function peg$parse__(){var t,r,n;if(t=ke,r=[],Ae.test(e.charAt(ke))?(n=e.charAt(ke),ke++):(n=a,0===He&&peg$fail(Ee)),n!==a)for(;n!==a;)r.push(n),Ae.test(e.charAt(ke))?(n=e.charAt(ke),ke++):(n=a,0===He&&peg$fail(Ee));else r=a;return t=r!==a?e.substring(t,ke):r}var Oe,Me=[];if((r=i())!==a&&ke===e.length)return r;throw r!==a&&ke<e.length&&peg$fail({type:"end"}),peg$buildStructuredError(je,Te<e.length?e.charAt(Te):null,Te<e.length?peg$computeLocation(Te,Te+1):peg$computeLocation(Te,Te))}}},function(e,t,r){"use strict";var a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=a(r(12)),i=a(r(7)),o=a(r(2)),l=a(r(1)),s=a(r(0)),p=a(r(3)),u=a(r(6)),c=a(r(5));var f=new l.default({name:"[root]",display:"container-block",render:e=>e.html(e.innerHtml)});t.default={ast2nt:function ast2nt(e,t){t||(t={}),t.tags||(t.tags={});var r=i.default.tags(n.default,t.tags);return function recurse(e){if("root"==e.type)return f.instantiate({code:e.code,attributes:[],children:e.children.map(recurse),options:t});if("text"==e.type)return new u.default(e.text);if("error"==e.type)return new p.default({message:"Parser error",code:e.text});if("element"==e.type){if(e.name in r&&r[e.name]){if(r[e.name].split){var recurseSplit=(e,t)=>{if(0==t.length)return e.map(recurse);var r,a=t[t.length-1],n=[];(e=e.map((e=>"element"!=e.type||e.name!=a||e.children.length?e:{type:"delimiter"}))).length&&"text"==e[0].type&&!e[0].text.trim()&&(e=e.slice(1)),e.length&&"delimiter"==e[0].type||e.unshift({type:"delimiter"});for(var i=0;i<e.length;i++)"delimiter"==e[i].type?(r&&n.push(r),r=[]):r.push(e[i]);return n.push(r),n.map((e=>recurseSplit(e,t.slice(0,-1))))};return r[e.name].instantiate({code:e.code,attributes:e.attributes,children:recurseSplit(e.children,r[e.name].split),options:t})}return r[e.name].instantiate({code:e.code,attributes:e.attributes,children:e.children.map(recurse),options:t})}return new p.default({message:e.name?`Undefined tag name [${e.name}]`:"No tag name",code:e.code})}throw TypeError(e.type)}(e.root)},Node:s.default,TextNode:u.default,HtmlNode:c.default,ErrorNode:p.default,ElementClass:l.default,Element:o.default}},function(e,t,r){"use strict";var a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=a(r(1));var i={};function normalizeUrl(e){return e=e.trim(),/^#/.test(e)?!!/^#[^\s]*$/.test(e)&&e:/^(\/|\.\/|\.\.\/)/.test(e)?!!/^(\/|\.\/|\.\.\/)[^\s]*$/.test(e)&&e:(/^(http:\/\/|https:\/\/|ftp:\/\/)/.test(e)||(e="http://"+e),!!/^(http:\/\/|https:\/\/|ftp:\/\/)[a-z0-9]+(-+[a-z0-9]+)*(\.[a-z0-9]+(-+[a-z0-9]+)*)+\.?(:[0-9]{1,5})?(\/[^\s]*)?$/.test(e)&&e)}i.comment=new n.default({name:"comment",display:"inline",render:e=>e.text("")}),i.entity=new n.default({name:"entity",display:"inline",render:e=>e.innerIsText?/^([a-z]{1,50}|#[0-9]{1,10}|#x[0-9a-f]{1,10})$/i.test(e.innerText)?e.html(`&${e.innerText};`):e.error("Invalid value"):e.error("Non-text input")}),["b","code","i","u","sup","sub"].forEach((e=>i[e]=new n.default({name:e,display:"inline",render:t=>t.html(`<${e}>${t.innerHtml}</${e}>`)}))),["h1","h2","h3","h4","h5","h6","p"].forEach((e=>i[e]=new n.default({name:e,display:"leaf-block",render:t=>t.html(`<${e}>${t.innerHtml}</${e}>`)}))),i.blockquote=new n.default({name:"blockquote",display:"container-block",render:e=>{var t=e.getAttribute("type");return["info","warn"].includes(t)?e.html(`<blockquote class="m42kup-bq-${t}">${e.innerHtml}</blockquote>`):e.html(`<blockquote>${e.innerHtml}</blockquote>`)}}),["br"].forEach((e=>i[e]=new n.default({name:e,display:"inline",render:t=>t.html(`<${e}>${t.innerHtml}`)}))),["hr"].forEach((e=>i[e]=new n.default({name:e,display:"leaf-block",render:t=>t.html(`<${e}>${t.innerHtml}`)}))),["ul","ol"].forEach((e=>{i[e]=new n.default({name:e,display:"container-block",split:"*",render:t=>t.html(`<${e}>`+t.innerHtml.map((e=>`<li>${e}</li>`)).join("")+`</${e}>`)})})),i.table=new n.default({name:"table",display:"container-block",split:["*","**"],render:e=>{var t=e.innerHtml.map((e=>e.length)).reduce(((e,t)=>e<t?t:e));return e.html("<table>"+e.innerHtml.map((e=>`<tr>${e.concat(Array(t-e.length).fill("")).map((e=>`<td>${e}</td>`)).join("")}</tr>`)).join("")+"</table>")}}),i.blockcode=new n.default({name:"blockcode",display:"leaf-block",render:e=>{var t=e.innerHtml.replace(/(^[ \t]*(\r\n|\r|\n))|((\r\n|\r|\n)[ \t]*$)/g,"");return e.html(`<pre><code>${t}\n</code></pre>`)}}),i.bi=new n.default({name:"bi",display:"inline",render:e=>e.html(`<i><b>${e.innerHtml}</b></i>`)}),i.link=new n.default({name:"link",display:"inline",render:e=>{var t=e.getAttribute("href");if(null==t){if(!e.innerIsText)return e.error("Non-text input");let t=normalizeUrl(e.innerText);if(!t)return e.error("Invalid URL");let r=e.escapeHtml(t);return e.html(`<a href="${r}" title="${r}">${r}</a>`)}{let r=normalizeUrl(t);if(!r)return e.error("Invalid URL");let a=e.escapeHtml(r);return e.html(`<a href="${a}" title="${a}">${e.innerHtml}</a>`)}}}),i.img=new n.default({name:"img",display:"leaf-block",render:e=>{if(!e.innerIsText)return e.error("Non-text input");var t=normalizeUrl(e.innerText);if(!t)return e.error("Invalid URL");var r=e.escapeHtml(t);return e.html(`<img src="${r}">`)}}),["squote","dquote"].forEach((e=>i[e]=new n.default({name:e,display:"inline",render:t=>{var r={squote:{normal:["‘","’"],angle:["〈","〉"],corner:["「","」"]},dquote:{normal:["“","”"],angle:["《","》"],corner:["『","』"]}},a=t.getAttribute("type");return["angle","corner"].includes(a)||(a="normal"),t.html(`${r[e][a][0]}${t.innerHtml}${r[e][a][1]}`)}}))),i.highlight=new n.default({name:"highlight",display:"leaf-block",render:(e,t)=>{if(!t.hljs)return e.error("Element not implemented (options.highlight not given)");if(!e.innerIsText)return e.error("Non-text input");var r,a=["apache","bash","coffeescript","cpp","cs","css","diff","http","ini","java","javascript","json","makefile","xml","markdown","nginx","objectivec","perl","php","python","ruby","sql"],n=e.innerText.replace(/(^[ \t]*(\r\n|\r|\n))|((\r\n|\r|\n)[ \t]*$)/g,"");if(a.includes(e.getAttribute("lang"))){var i=e.getAttribute("lang");r=t.hljs.highlight(i,n).value}else r=t.hljs.highlightAuto(n,a).value;return e.html(`<pre class="hljs"><code>${r}\n</code></pre>`)}}),i.math=new n.default({name:"math",display:"inline",render:(e,t)=>{if(!t.katex)return e.error("Element not implemented (options.katex not given)");if(!e.innerIsText)return e.error("Non-text input");var r=t.katex.renderToString(e.innerText,{throwOnError:!1,displayMode:!1,strict:"error"});return e.html(r)}}),i.displaymath=new n.default({name:"displaymath",display:"leaf-block",render:(e,t)=>{if(!t.katex)return e.error("Element not implemented (options.katex not given)");if(!e.innerIsText)return e.error("Non-text input");var r=t.katex.renderToString(e.innerText,{throwOnError:!1,displayMode:!0,strict:"error"});return e.html(r)}});var o={'"':"dquote",$:"math",$$:"displaymath","%":"comment","&":"entity","'":"squote","*":"i","**":"b","***":"bi",";":"code",";;":"blockcode",";;;":"highlight","=":"h1","==":"h2","===":"h3","====":"h4","=====":"h5","======":"h6",">":"blockquote","\\":"br","^":"sup",_:"sub","~":"link","~~":"img"};for(var l in o){if(!i[o[l]])throw TypeError("aliasing failed");i[l]=i[o[l]]}t.default=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});function makeHtml(e){return`<span class="m42hl-${e.type}">${e.html||(t=e.text,(t+"").replace(/[&<>"']/g,(e=>({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"}[e]))))}</span>`;var t}t.default={pt2hl:function pt2hl(e){return function recurse(e){for(var t="",r=0;r<e.length;r++)switch(e[r].type){case"text":t+=makeHtml({type:"tx",text:e[r].text});break;case"element":var a=makeHtml({type:"lbm",text:e[r].lbm})+makeHtml({type:"tn",text:e[r].name})+(e=>{switch(e._type){case"parenthesis":return makeHtml({type:"lpm",text:e.left})+e.content.map((e=>{switch(e._type){case"attribute":return makeHtml({type:"pk",text:e.attribute[0]})+makeHtml({type:"eq",text:e.attribute[1]})+makeHtml({type:"lqm",text:e.attribute[2]})+makeHtml({type:"pv",text:e.attribute[3]})+makeHtml({type:"rqm",text:e.attribute[4]});case"whitespace":return makeHtml({type:"tx",text:e.whitespace});case"error":return makeHtml({type:"err",text:e.error});default:throw Error("Unknown type")}})).join("")+makeHtml({type:"rpm",text:e.right});case"separator":return makeHtml({type:"sp",text:e.separator});default:throw Error("Unknown type")}})(e[r].attributes)+recurse(e[r].children)+makeHtml({type:"rbm",text:e[r].rbm});t+=makeHtml({type:"elem",html:a});break;case"verbatim":var n=makeHtml({type:"lvm",text:e[r].lvm+e[r].separator})+makeHtml({type:"tx",text:e[r].child.text})+makeHtml({type:"rvm",text:e[r].rvm});t+=makeHtml({type:"verb",html:n});break;default:throw new TypeError(`Unknown type: ${e[r].type}`)}return t}(e.root.children)}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=4,n=5;t.default=function addCodeMirrorMode(e){function token(e,t){if((t.levels[t.levels.length-1]||0)<0){var r=-t.levels[t.levels.length-1],i=">".repeat(r-1)+"`";return e.skipTo(i)?(e.match(i),t.levels.pop()):e.skipToEnd(),"comment"}var o=e.peek();if(![a,n].includes(t.status)&&[">","]"].includes(o)&&(p=t.levels[t.levels.length-1]||0)>0){var l=">".repeat(p-1)+"]";if(e.match(l))return t.levels.pop(),t.status=0,"tag"}if(0!=t.status){if(e.match(")"))return t.status=0,"tag";if(1==t.status)return e.match(/^[a-z0-9-]+/)?(t.status=2,"attribute"):e.match(/^[ \t\n\r]+/)?null:(e.next(),"error");if(2==t.status)return e.match("=")?(t.status=3,null):(t.status=1,null);if(3==t.status)return e.match('"')?(t.status=a,"string"):e.match("'")?(t.status=n,"string"):(e.match(/^[^'"()\[\] \t\n\r]*/),t.status=1,"string");if(t.status==a)return e.skipTo('"')?(e.match('"'),t.status=1):e.skipToEnd(),"string";if(t.status==n)return e.skipTo("'")?(e.match("'"),t.status=1):e.skipToEnd(),"string"}if("`"==o){e.next();for(var s=1;o=e.next();){if("<"!=o){e.backUp(1);break}s++}return t.levels.push(-s),"comment"}if("["==o){e.next();for(s=1;o=e.next();){if("<"!=o){e.backUp(1);break}s++}if(s<(t.levels[t.levels.length-1]||0))return null;if(e.match(/^(?:\!+|\"+|\#+|\$+|\%+|\&+|\'+|\)+|\*+|\++|\,+|\-+|\/+|\;+|\=+|\>+|\?+|\@+|\\+|\^+|\_+|\{+|\|+|\}+|\~+|[a-z][a-z0-9]*(?:\:[a-z][a-z0-9]*)*|)/),e.match("("))t.status=1;else{e.match(/^(?:[.]|)/i)}return t.levels.push(s),"tag"}if(">"==o||"]"==o){var p;if((p=t.levels[t.levels.length-1]||0)<=0)return e.next(),null;l=">".repeat(p-1)+"]";return e.match(l)?(t.levels.pop(),"tag"):(e.next(),null)}e.match(/^[^\[\]`>]+/)}e.defineMode("m42kup",((e,t)=>({startState:e=>({levels:[],status:0}),token:token})))}}])}));
//# sourceMappingURL=m42kup.min.js.map