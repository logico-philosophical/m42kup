!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.m42kup=e():t.m42kup=e()}("undefined"!=typeof self?self:this,(function(){return function(t){var e={};function r(n){if(e[n])return e[n].exports;var a=e[n]={i:n,l:!1,exports:{}};return t[n].call(a.exports,a,a.exports,r),a.l=!0,a.exports}return r.m=t,r.c=e,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)r.d(n,a,function(e){return t[e]}.bind(null,a));return n},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=8)}([function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.default=class{toString(){return this.toIndentedString(0)}}},function(t,e,r){"use strict";var n=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const a=n(r(2));class i{constructor({name:t,display:e,render:r,split:n}){if(!t)throw TypeError("You give arg0 a bad name");if(!["inline","leaf-block","container-block"].includes(e))throw TypeError('arg0.display should be one of "inline", "leaf-block", or "container-block".');if(!(r instanceof Function))throw TypeError("arg0.render should be a function");if([this.name,this.display]=[t,e],this.render=(t,e)=>{if(!(t instanceof a.default))throw TypeError("arg0 should be an instance of m42kup.renderer.Element");return r(t,e)},void 0!==n){if("string"==typeof n&&(n=[n]),!(n instanceof Array))throw TypeError("arg0.split should be either undefined, a string, or an array");if(!n.length)throw TypeError("arg0.split.length == 0");this.split=n}}instantiate({code:t,attributes:e,children:r,options:n}){if(!(this instanceof i))throw Error("ElementClass.prototype.instantiate should be called as a method of an ElementClass instance");return new a.default({name:this.name,display:this.display,render:this.render,code:t,attributes:e,children:r,split:this.split,options:n})}}e.default=i},function(t,e,r){"use strict";var n=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const a=n(r(3)),i=n(r(4)),o=n(r(5)),s=n(r(0)),l=n(r(6));class u extends s.default{constructor({name:t,display:e,render:r,code:n,attributes:s,children:c,split:f,options:h}){if(super(),!t)throw TypeError("You give arg0 a bad name");if(!["inline","leaf-block","container-block"].includes(e))throw TypeError('arg0.display should be one of "inline", "leaf-block", or "container-block".');if(!(r instanceof Function))throw TypeError("arg0.render should be a function");if("string"!=typeof n)throw TypeError("You give arg0 a bad code");if(!(s instanceof Array))throw TypeError("attributes should be an array");if((()=>{var t=e=>e instanceof u||e instanceof l.default||e instanceof a.default||e instanceof Array&&e.every(t);if(!c.every(t))throw TypeError("All arg0.children should either be an Element, a TextNode, or an ErrorNode")})(),void 0!==f){if("string"==typeof f&&(f=[f]),!(f instanceof Array))throw TypeError("arg0.split should be either undefined, a string, or an array");if(!f.length)throw TypeError("arg0.split.length == 0");this.split=f}var d,p;[this.name,this.display,this.code,this.attributes,this.children]=[t,e,n,s,c],this.innerIsText=(d=f?f.length:0,(p=(t,e)=>e>0?t.map(t=>p(t,e-1)):t.map(t=>t instanceof l.default||!(t instanceof a.default)&&t.outerIsText).every(t=>t))(c,d)),this.innerText=(()=>{var t=f?f.length:0,e=(t,r,n)=>r>0?t.map((t,a)=>e(t,r-1,n[a])):n?t.map(t=>t instanceof l.default?t.text:t.outerText).join(""):null;return e(c,t,this.innerIsText)})(),this.innerHtml=(()=>{var t=f?f.length:0,e=(t,r,n,o)=>{if(r>0)return t.map((t,a)=>e(t,r-1,n[a],o[a]));if(n)return o.trim()&&"container-block"==this.display?o.split(/(?:\r\n[ \t]*){2,}|(?:\r[ \t]*){2,}|(?:\n[ \t]*){2,}/).filter(t=>!!t.trim()).map(i.default).map(t=>`<p>${t}</p>`).join(""):i.default(o);if("container-block"!=this.display)return t.map(t=>t instanceof l.default?i.default(t.text):t instanceof a.default?t.toHtml():t.outerHtml).join("");var s=[],u=[],c=()=>{u.length&&(s.push(u),u=[])},f=t=>u.push(t);return t.forEach(t=>{if(t instanceof l.default){var e=t.text.split(/(?:\r\n[ \t]*){2,}|(?:\r[ \t]*){2,}|(?:\n[ \t]*){2,}/);if(e.length<2)return f(t);e.forEach((t,r)=>{t.trim()&&f(this.text(t)),r<e.length-1&&c()})}else t instanceof a.default?f(t):"inline"!=t.display?(c(),s.push(t),c()):f(t)}),c(),s.map(t=>t instanceof Array?"<p>"+t.map(t=>t instanceof l.default?i.default(t.text):t instanceof a.default?t.toHtml():t.outerHtml).join("")+"</p>":t.outerHtml).join("")};return e(c,t,this.innerIsText,this.innerText)})();var m=r(this,h);if(this.outerIsText=m instanceof l.default,this.outerText=this.outerIsText?m.text:null,this.isError=m instanceof a.default,this.errorMessage=m instanceof a.default?m.message:null,this.outerIsText)this.outerHtml=i.default(this.outerText);else if(m instanceof o.default)this.outerHtml=m.html;else{if(!(m instanceof a.default))throw TypeError("Render output should be one of TextNode, HtmlNode, or ErrorNode");this.outerHtml=m.toHtml()}}text(t){return new l.default(t)}html(t){return new o.default({html:t,display:this.display})}error(t){return new a.default({message:`[${this.name}]: ${t}`,code:this.code})}getAttribute(t){for(var e=0;e<this.attributes.length;e++)if(this.attributes[e].name==t)return this.attributes[e].value;return null}toIndentedString(t){var e=["display","code","attributes","split","isError","errorMessage","innerIsText","innerText","innerHtml","outerIsText","outerText","outerHtml"].map(t=>t+"="+("string"==typeof this[t]||this[t]instanceof Array?JSON.stringify(this[t]):this[t]+"")).join("\n"+"\t".repeat(t+1)),r=this.children.map(e=>e.toIndentedString(t+1)).join(",\n");return"\t".repeat(t)+`Element[${JSON.stringify(this.name)}](\n`+`${"\t".repeat(t+1)}${e}\n`+"\t".repeat(t)+") {\n"+r+"\n"+"\t".repeat(t)+"}"}escapeHtml(t){return i.default(t)}}e.default=u},function(t,e,r){"use strict";var n=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const a=n(r(4)),i=n(r(0));class o extends i.default{constructor({message:t,code:e}){if(super(),"string"!=typeof t)throw TypeError("message not string");if("string"!=typeof e)throw TypeError("code not string");this.message=t,this.code=e}toHtml(){return`<code class="m42kup-error" title="Error: ${a.default(this.message)}">${a.default(this.code)}</code>`}toIndentedString(t){var e=["message","code"].map(t=>t+"="+JSON.stringify(this[t])).join(" ");return"\t".repeat(t)+`Error(${e})`}}e.default=o},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t){return(t+"").replace(/[&<>"']/g,t=>({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"}[t]))}},function(t,e,r){"use strict";var n=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const a=n(r(0));class i extends a.default{constructor({html:t,display:e}){if(super(),"string"!=typeof t)throw TypeError("html not string");if(!["inline","leaf-block","container-block"].includes(e))throw TypeError('arg0.display should be one of "inline", "leaf-block", or "container-block".');this.html=t,this.display=e}toIndentedString(t){var e=["display"].map(t=>t+"="+JSON.stringify(this[t])).join(" ");return"\t".repeat(t)+`Html(${e}) {${JSON.stringify(this.html)}}`}}e.default=i},function(t,e,r){"use strict";var n=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const a=n(r(0));class i extends a.default{constructor(t){if(super(),"string"!=typeof t)throw TypeError("text not string");this.text=t}toIndentedString(t){return"\t".repeat(t)+`Text {${JSON.stringify(this.text)}}`}}e.default=i},function(t,e,r){"use strict";function n(t){var e={};for(var r in t)e[r]=t[r];return e}function a(t){var e={};return t.tags&&(e.tags=n(t.tags)),t.hljs&&(e.hljs=t.hljs),t.katex&&(e.katex=t.katex),e}function i(t,e){for(var r in t=n(t),e)t[r]=e[r];return t}Object.defineProperty(e,"__esModule",{value:!0}),e.default={copyOptions:a,tags:i,options:function(t,e){if("object"!=typeof t||"object"!=typeof e)throw TypeError("One of the options provided is not an object");return t=a(t),e.tags&&(t.tags||(t.tags={}),t.tags=i(t.tags,e.tags)),e.hljs&&(t.hljs=e.hljs),e.katex&&(t.katex=e.katex),t}}},function(t,e,r){"use strict";var n=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const a=n(r(9)),i=n(r(11)),o=n(r(13)),s=n(r(7)),l=n(r(14));var u={};var c={parser:a.default,renderer:i.default,highlighter:o.default,ast2nt:function(t,e){return e||(e={}),e.tags||(e.tags={}),e=s.default.options(u,e),i.default.ast2nt(t,e)},render:function(t,e){t+="",e||(e={}),e.tags||(e.tags={}),e=s.default.options(u,e);var r=a.default.input2pt(t),n=a.default.pt2ast(r);return i.default.ast2nt(n,e).outerHtml},highlight:function(t){t+="";var e=a.default.input2pt(t);return o.default.pt2hl(e)},cascade:function(t){if("object"!=typeof t)throw TypeError("typeof options != 'object'");u=s.default.options(u,t)},set:function(t){if("object"!=typeof t)throw TypeError("typeof options != 'object'");u=t},addCodeMirrorMode:l.default};t.exports=c},function(t,e,r){"use strict";var n=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const a=n(r(10));e.default={input2pt:function(t){var e=a.default.parse(t);return e.input=t,e},pt2ast:function(t){var e=t.input,r=function t(r){var n=r.map(r=>{switch(r.type){case"text":return{type:"text",text:r.text};case"verbatim":return{type:"text",text:r.child.text};case"element":var n="parenthesis"!=r.attributes._type?[]:r.attributes.content.filter(({_type:t})=>"attribute"==t).map(({attribute:t})=>({name:t[0],value:t[3]}));return{type:"element",name:r.name,attributes:n,code:e.substring(r.location.start.offset,r.location.end.offset),children:t(r.children)};default:throw new TypeError("Unknown type: "+r.type)}});return n=n.reduce((t,e)=>{if("text"==e.type){if(!e.text)return t;if(t.length&&"text"==t[t.length-1].type)return t[t.length-1].text+=e.text,t}return t.push(e),t},[])}(t.root.children);return{input:t.input,root:{type:"root",children:r,code:e}}}}},function(t,e,r){"use strict";function n(t,e,r,a){this.message=t,this.expected=e,this.found=r,this.location=a,this.name="SyntaxError","function"==typeof Error.captureStackTrace&&Error.captureStackTrace(this,n)}!function(t,e){function r(){this.constructor=t}r.prototype=e.prototype,t.prototype=new r}(n,Error),n.buildMessage=function(t,e){var r={literal:function(t){return'"'+a(t.text)+'"'},class:function(t){var e,r="";for(e=0;e<t.parts.length;e++)r+=t.parts[e]instanceof Array?i(t.parts[e][0])+"-"+i(t.parts[e][1]):i(t.parts[e]);return"["+(t.inverted?"^":"")+r+"]"},any:function(t){return"any character"},end:function(t){return"end of input"},other:function(t){return t.description}};function n(t){return t.charCodeAt(0).toString(16).toUpperCase()}function a(t){return t.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(function(t){return"\\x0"+n(t)})).replace(/[\x10-\x1F\x7F-\x9F]/g,(function(t){return"\\x"+n(t)}))}function i(t){return t.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(function(t){return"\\x0"+n(t)})).replace(/[\x10-\x1F\x7F-\x9F]/g,(function(t){return"\\x"+n(t)}))}return"Expected "+function(t){var e,n,a,i=new Array(t.length);for(e=0;e<t.length;e++)i[e]=(a=t[e],r[a.type](a));if(i.sort(),i.length>0){for(e=1,n=1;e<i.length;e++)i[e-1]!==i[e]&&(i[n]=i[e],n++);i.length=n}switch(i.length){case 1:return i[0];case 2:return i[0]+" or "+i[1];default:return i.slice(0,-1).join(", ")+", or "+i[i.length-1]}}(t)+" but "+function(t){return t?'"'+a(t)+'"':"end of input"}(e)+" found."},t.exports={SyntaxError:n,parse:function(t,e){e=void 0!==e?e:{};var r,a={},i={start:gt},o=gt,s=ct("[",!1),l=ct("<",!1),u=ct("!",!1),c=ct('"',!1),f=ct("#",!1),h=ct("$",!1),d=ct("%",!1),p=ct("&",!1),m=ct("'",!1),g=ct(")",!1),y=ct("*",!1),v=ct("+",!1),b=ct(",",!1),A=ct("-",!1),x=ct("/",!1),C=ct(";",!1),_=ct("=",!1),w=ct(">",!1),k=ct("?",!1),T=ct("@",!1),E=ct("\\",!1),j=ct("^",!1),$=ct("_",!1),M=ct("{",!1),H=ct("|",!1),O=ct("}",!1),S=ct("~",!1),I=/^[a-z]/,N=ft([["a","z"]],!1,!1),q=/^[a-z0-9]/,P=ft([["a","z"],["0","9"]],!1,!1),z=ct(":",!1),U=function(t,e,r,n){return":"+r+n.join("")},F=ct("(",!1),D=/^[a-z0-9\-]/,R=ft([["a","z"],["0","9"],"-"],!1,!1),J={type:"any"},L=function(t,e,r,n,a,i){return[r,n,a,i]},Y=/^['"()[\] \t\n\r]/,B=ft(["'",'"',"(",")","[","]"," ","\t","\n","\r"],!1,!1),G=function(t,e,r,n){return[r,"",n,""]},K=function(t,e,r){return{_type:"attribute",attribute:[e].concat(r)}},Q=function(t,e){return{_type:"whitespace",whitespace:e}},V=function(t,e){return{_type:"error",error:e}},W=ct(".",!1),X=ct("]",!1),Z=ct("`",!1),tt=function(t){return{type:"text",text:t.join(""),location:ut()}},et=/^[ \t\n\r]/,rt=ft([" ","\t","\n","\r"],!1,!1),nt=0,at=0,it=[{line:1,column:1}],ot=0,st=[],lt=0;if("startRule"in e){if(!(e.startRule in i))throw new Error("Can't start parsing from rule \""+e.startRule+'".');o=i[e.startRule]}function ut(){return dt(at,nt)}function ct(t,e){return{type:"literal",text:t,ignoreCase:e}}function ft(t,e,r){return{type:"class",parts:t,inverted:e,ignoreCase:r}}function ht(e){var r,n=it[e];if(n)return n;for(r=e-1;!it[r];)r--;for(n={line:(n=it[r]).line,column:n.column};r<e;)10===t.charCodeAt(r)?(n.line++,n.column=1):n.column++,r++;return it[e]=n,n}function dt(t,e){var r=ht(t),n=ht(e);return{start:{offset:t,line:r.line,column:r.column},end:{offset:e,line:n.line,column:n.column}}}function pt(t){nt<ot||(nt>ot&&(ot=nt,st=[]),st.push(t))}function mt(t,e,r){return new n(n.buildMessage(t,e),t,e,r)}function gt(){var t,e;return t=nt,(e=yt())!==a&&(at=t,e={root:{type:"root",children:e,location:ut()}}),t=e}function yt(){var t,e;for(t=[],e=vt();e!==a;)t.push(e),e=vt();return t}function vt(){var e;return(e=function(){var e,r,n,i,o,s;e=nt,(r=function(){var t,e;t=nt,(e=bt())!==a&&(at=t,r=e,kt.push(r.length),e=r);var r;return t=e}())!==a&&(n=function(){var e,r,n,i,o,s,l,F,D,R;e=nt,r=[],33===t.charCodeAt(nt)?(n="!",nt++):(n=a,0===lt&&pt(u));if(n!==a)for(;n!==a;)r.push(n),33===t.charCodeAt(nt)?(n="!",nt++):(n=a,0===lt&&pt(u));else r=a;if(r===a){if(r=[],34===t.charCodeAt(nt)?(n='"',nt++):(n=a,0===lt&&pt(c)),n!==a)for(;n!==a;)r.push(n),34===t.charCodeAt(nt)?(n='"',nt++):(n=a,0===lt&&pt(c));else r=a;if(r===a){if(r=[],35===t.charCodeAt(nt)?(n="#",nt++):(n=a,0===lt&&pt(f)),n!==a)for(;n!==a;)r.push(n),35===t.charCodeAt(nt)?(n="#",nt++):(n=a,0===lt&&pt(f));else r=a;if(r===a){if(r=[],36===t.charCodeAt(nt)?(n="$",nt++):(n=a,0===lt&&pt(h)),n!==a)for(;n!==a;)r.push(n),36===t.charCodeAt(nt)?(n="$",nt++):(n=a,0===lt&&pt(h));else r=a;if(r===a){if(r=[],37===t.charCodeAt(nt)?(n="%",nt++):(n=a,0===lt&&pt(d)),n!==a)for(;n!==a;)r.push(n),37===t.charCodeAt(nt)?(n="%",nt++):(n=a,0===lt&&pt(d));else r=a;if(r===a){if(r=[],38===t.charCodeAt(nt)?(n="&",nt++):(n=a,0===lt&&pt(p)),n!==a)for(;n!==a;)r.push(n),38===t.charCodeAt(nt)?(n="&",nt++):(n=a,0===lt&&pt(p));else r=a;if(r===a){if(r=[],39===t.charCodeAt(nt)?(n="'",nt++):(n=a,0===lt&&pt(m)),n!==a)for(;n!==a;)r.push(n),39===t.charCodeAt(nt)?(n="'",nt++):(n=a,0===lt&&pt(m));else r=a;if(r===a){if(r=[],41===t.charCodeAt(nt)?(n=")",nt++):(n=a,0===lt&&pt(g)),n!==a)for(;n!==a;)r.push(n),41===t.charCodeAt(nt)?(n=")",nt++):(n=a,0===lt&&pt(g));else r=a;if(r===a){if(r=[],42===t.charCodeAt(nt)?(n="*",nt++):(n=a,0===lt&&pt(y)),n!==a)for(;n!==a;)r.push(n),42===t.charCodeAt(nt)?(n="*",nt++):(n=a,0===lt&&pt(y));else r=a;if(r===a){if(r=[],43===t.charCodeAt(nt)?(n="+",nt++):(n=a,0===lt&&pt(v)),n!==a)for(;n!==a;)r.push(n),43===t.charCodeAt(nt)?(n="+",nt++):(n=a,0===lt&&pt(v));else r=a;if(r===a){if(r=[],44===t.charCodeAt(nt)?(n=",",nt++):(n=a,0===lt&&pt(b)),n!==a)for(;n!==a;)r.push(n),44===t.charCodeAt(nt)?(n=",",nt++):(n=a,0===lt&&pt(b));else r=a;if(r===a){if(r=[],45===t.charCodeAt(nt)?(n="-",nt++):(n=a,0===lt&&pt(A)),n!==a)for(;n!==a;)r.push(n),45===t.charCodeAt(nt)?(n="-",nt++):(n=a,0===lt&&pt(A));else r=a;if(r===a){if(r=[],47===t.charCodeAt(nt)?(n="/",nt++):(n=a,0===lt&&pt(x)),n!==a)for(;n!==a;)r.push(n),47===t.charCodeAt(nt)?(n="/",nt++):(n=a,0===lt&&pt(x));else r=a;if(r===a){if(r=[],59===t.charCodeAt(nt)?(n=";",nt++):(n=a,0===lt&&pt(C)),n!==a)for(;n!==a;)r.push(n),59===t.charCodeAt(nt)?(n=";",nt++):(n=a,0===lt&&pt(C));else r=a;if(r===a){if(r=[],61===t.charCodeAt(nt)?(n="=",nt++):(n=a,0===lt&&pt(_)),n!==a)for(;n!==a;)r.push(n),61===t.charCodeAt(nt)?(n="=",nt++):(n=a,0===lt&&pt(_));else r=a;if(r===a){if(r=[],62===t.charCodeAt(nt)?(n=">",nt++):(n=a,0===lt&&pt(w)),n!==a)for(;n!==a;)r.push(n),62===t.charCodeAt(nt)?(n=">",nt++):(n=a,0===lt&&pt(w));else r=a;if(r===a){if(r=[],63===t.charCodeAt(nt)?(n="?",nt++):(n=a,0===lt&&pt(k)),n!==a)for(;n!==a;)r.push(n),63===t.charCodeAt(nt)?(n="?",nt++):(n=a,0===lt&&pt(k));else r=a;if(r===a){if(r=[],64===t.charCodeAt(nt)?(n="@",nt++):(n=a,0===lt&&pt(T)),n!==a)for(;n!==a;)r.push(n),64===t.charCodeAt(nt)?(n="@",nt++):(n=a,0===lt&&pt(T));else r=a;if(r===a){if(r=[],92===t.charCodeAt(nt)?(n="\\",nt++):(n=a,0===lt&&pt(E)),n!==a)for(;n!==a;)r.push(n),92===t.charCodeAt(nt)?(n="\\",nt++):(n=a,0===lt&&pt(E));else r=a;if(r===a){if(r=[],94===t.charCodeAt(nt)?(n="^",nt++):(n=a,0===lt&&pt(j)),n!==a)for(;n!==a;)r.push(n),94===t.charCodeAt(nt)?(n="^",nt++):(n=a,0===lt&&pt(j));else r=a;if(r===a){if(r=[],95===t.charCodeAt(nt)?(n="_",nt++):(n=a,0===lt&&pt($)),n!==a)for(;n!==a;)r.push(n),95===t.charCodeAt(nt)?(n="_",nt++):(n=a,0===lt&&pt($));else r=a;if(r===a){if(r=[],123===t.charCodeAt(nt)?(n="{",nt++):(n=a,0===lt&&pt(M)),n!==a)for(;n!==a;)r.push(n),123===t.charCodeAt(nt)?(n="{",nt++):(n=a,0===lt&&pt(M));else r=a;if(r===a){if(r=[],124===t.charCodeAt(nt)?(n="|",nt++):(n=a,0===lt&&pt(H)),n!==a)for(;n!==a;)r.push(n),124===t.charCodeAt(nt)?(n="|",nt++):(n=a,0===lt&&pt(H));else r=a;if(r===a){if(r=[],125===t.charCodeAt(nt)?(n="}",nt++):(n=a,0===lt&&pt(O)),n!==a)for(;n!==a;)r.push(n),125===t.charCodeAt(nt)?(n="}",nt++):(n=a,0===lt&&pt(O));else r=a;if(r===a)if(r=[],126===t.charCodeAt(nt)?(n="~",nt++):(n=a,0===lt&&pt(S)),n!==a)for(;n!==a;)r.push(n),126===t.charCodeAt(nt)?(n="~",nt++):(n=a,0===lt&&pt(S));else r=a}}}}}}}}}}}}}}}}}}}}}}}e=r!==a?t.substring(e,nt):r;if(e===a){if(e=nt,I.test(t.charAt(nt))?(r=t.charAt(nt),nt++):(r=a,0===lt&&pt(N)),r!==a){for(n=nt,i=[],q.test(t.charAt(nt))?(o=t.charAt(nt),nt++):(o=a,0===lt&&pt(P));o!==a;)i.push(o),q.test(t.charAt(nt))?(o=t.charAt(nt),nt++):(o=a,0===lt&&pt(P));if((n=i!==a?t.substring(n,nt):i)!==a){if(i=nt,o=[],s=nt,58===t.charCodeAt(nt)?(l=":",nt++):(l=a,0===lt&&pt(z)),l!==a)if(I.test(t.charAt(nt))?(F=t.charAt(nt),nt++):(F=a,0===lt&&pt(N)),F!==a){for(D=[],q.test(t.charAt(nt))?(R=t.charAt(nt),nt++):(R=a,0===lt&&pt(P));R!==a;)D.push(R),q.test(t.charAt(nt))?(R=t.charAt(nt),nt++):(R=a,0===lt&&pt(P));D!==a?(at=s,l=U(0,0,F,D),s=l):(nt=s,s=a)}else nt=s,s=a;else nt=s,s=a;for(;s!==a;)if(o.push(s),s=nt,58===t.charCodeAt(nt)?(l=":",nt++):(l=a,0===lt&&pt(z)),l!==a)if(I.test(t.charAt(nt))?(F=t.charAt(nt),nt++):(F=a,0===lt&&pt(N)),F!==a){for(D=[],q.test(t.charAt(nt))?(R=t.charAt(nt),nt++):(R=a,0===lt&&pt(P));R!==a;)D.push(R),q.test(t.charAt(nt))?(R=t.charAt(nt),nt++):(R=a,0===lt&&pt(P));D!==a?(at=s,l=U(0,0,F,D),s=l):(nt=s,s=a)}else nt=s,s=a;else nt=s,s=a;(i=o!==a?t.substring(i,nt):o)!==a?(at=e,e=r=r+n+i):(nt=e,e=a)}else nt=e,e=a}else nt=e,e=a;e===a&&(e="")}return e}())!==a&&(i=function(){var e,r,n,i,o,s,l,u,f,h,d,p,y;e=nt,40===t.charCodeAt(nt)?(r="(",nt++):(r=a,0===lt&&pt(F));if(r!==a){if(n=[],i=nt,o=nt,s=[],D.test(t.charAt(nt))?(l=t.charAt(nt),nt++):(l=a,0===lt&&pt(R)),l!==a)for(;l!==a;)s.push(l),D.test(t.charAt(nt))?(l=t.charAt(nt),nt++):(l=a,0===lt&&pt(R));else s=a;if((o=s!==a?t.substring(o,nt):s)!==a){if(s=nt,61===t.charCodeAt(nt)?(l="=",nt++):(l=a,0===lt&&pt(_)),l!==a)if(34===t.charCodeAt(nt)?(u='"',nt++):(u=a,0===lt&&pt(c)),u!==a){for(f=nt,h=[],d=nt,p=nt,lt++,34===t.charCodeAt(nt)?(y='"',nt++):(y=a,0===lt&&pt(c)),lt--,y===a?p=void 0:(nt=p,p=a),p!==a?(t.length>nt?(y=t.charAt(nt),nt++):(y=a,0===lt&&pt(J)),y!==a?d=p=[p,y]:(nt=d,d=a)):(nt=d,d=a);d!==a;)h.push(d),d=nt,p=nt,lt++,34===t.charCodeAt(nt)?(y='"',nt++):(y=a,0===lt&&pt(c)),lt--,y===a?p=void 0:(nt=p,p=a),p!==a?(t.length>nt?(y=t.charAt(nt),nt++):(y=a,0===lt&&pt(J)),y!==a?d=p=[p,y]:(nt=d,d=a)):(nt=d,d=a);(f=h!==a?t.substring(f,nt):h)!==a?(34===t.charCodeAt(nt)?(h='"',nt++):(h=a,0===lt&&pt(c)),h===a&&(h=nt,(d=xt())!==a&&(at=h,d=""),h=d),h!==a?(at=s,l=L(0,0,l,u,f,h),s=l):(nt=s,s=a)):(nt=s,s=a)}else nt=s,s=a;else nt=s,s=a;if(s===a){if(s=nt,61===t.charCodeAt(nt)?(l="=",nt++):(l=a,0===lt&&pt(_)),l!==a)if(39===t.charCodeAt(nt)?(u="'",nt++):(u=a,0===lt&&pt(m)),u!==a){for(f=nt,h=[],d=nt,p=nt,lt++,39===t.charCodeAt(nt)?(y="'",nt++):(y=a,0===lt&&pt(m)),lt--,y===a?p=void 0:(nt=p,p=a),p!==a?(t.length>nt?(y=t.charAt(nt),nt++):(y=a,0===lt&&pt(J)),y!==a?d=p=[p,y]:(nt=d,d=a)):(nt=d,d=a);d!==a;)h.push(d),d=nt,p=nt,lt++,39===t.charCodeAt(nt)?(y="'",nt++):(y=a,0===lt&&pt(m)),lt--,y===a?p=void 0:(nt=p,p=a),p!==a?(t.length>nt?(y=t.charAt(nt),nt++):(y=a,0===lt&&pt(J)),y!==a?d=p=[p,y]:(nt=d,d=a)):(nt=d,d=a);(f=h!==a?t.substring(f,nt):h)!==a?(39===t.charCodeAt(nt)?(h="'",nt++):(h=a,0===lt&&pt(m)),h===a&&(h=nt,(d=xt())!==a&&(at=h,d=""),h=d),h!==a?(at=s,l=L(0,0,l,u,f,h),s=l):(nt=s,s=a)):(nt=s,s=a)}else nt=s,s=a;else nt=s,s=a;if(s===a){if(s=nt,61===t.charCodeAt(nt)?(l="=",nt++):(l=a,0===lt&&pt(_)),l!==a){for(u=nt,f=[],h=nt,d=nt,lt++,Y.test(t.charAt(nt))?(p=t.charAt(nt),nt++):(p=a,0===lt&&pt(B)),lt--,p===a?d=void 0:(nt=d,d=a),d!==a?(t.length>nt?(p=t.charAt(nt),nt++):(p=a,0===lt&&pt(J)),p!==a?h=d=[d,p]:(nt=h,h=a)):(nt=h,h=a);h!==a;)f.push(h),h=nt,d=nt,lt++,Y.test(t.charAt(nt))?(p=t.charAt(nt),nt++):(p=a,0===lt&&pt(B)),lt--,p===a?d=void 0:(nt=d,d=a),d!==a?(t.length>nt?(p=t.charAt(nt),nt++):(p=a,0===lt&&pt(J)),p!==a?h=d=[d,p]:(nt=h,h=a)):(nt=h,h=a);(u=f!==a?t.substring(u,nt):f)!==a?(at=s,l=G(0,0,l,u),s=l):(nt=s,s=a)}else nt=s,s=a;s===a&&(s=nt,(l="")!==a&&(at=s,l=["","","",""]),s=l)}}s!==a?(at=i,o=K(0,o,s),i=o):(nt=i,i=a)}else nt=i,i=a;for(i===a&&(i=nt,(o=_t())!==a&&(at=i,o=Q(0,o)),(i=o)===a&&(i=nt,o=nt,s=nt,l=nt,lt++,41===t.charCodeAt(nt)?(u=")",nt++):(u=a,0===lt&&pt(g)),lt--,u===a?l=void 0:(nt=l,l=a),l!==a?(u=nt,lt++,f=At(),lt--,f===a?u=void 0:(nt=u,u=a),u!==a?(t.length>nt?(f=t.charAt(nt),nt++):(f=a,0===lt&&pt(J)),f!==a?s=l=[l,u,f]:(nt=s,s=a)):(nt=s,s=a)):(nt=s,s=a),(o=s!==a?t.substring(o,nt):s)!==a&&(at=i,o=V(0,o)),i=o));i!==a;){if(n.push(i),i=nt,o=nt,s=[],D.test(t.charAt(nt))?(l=t.charAt(nt),nt++):(l=a,0===lt&&pt(R)),l!==a)for(;l!==a;)s.push(l),D.test(t.charAt(nt))?(l=t.charAt(nt),nt++):(l=a,0===lt&&pt(R));else s=a;if((o=s!==a?t.substring(o,nt):s)!==a){if(s=nt,61===t.charCodeAt(nt)?(l="=",nt++):(l=a,0===lt&&pt(_)),l!==a)if(34===t.charCodeAt(nt)?(u='"',nt++):(u=a,0===lt&&pt(c)),u!==a){for(f=nt,h=[],d=nt,p=nt,lt++,34===t.charCodeAt(nt)?(y='"',nt++):(y=a,0===lt&&pt(c)),lt--,y===a?p=void 0:(nt=p,p=a),p!==a?(t.length>nt?(y=t.charAt(nt),nt++):(y=a,0===lt&&pt(J)),y!==a?d=p=[p,y]:(nt=d,d=a)):(nt=d,d=a);d!==a;)h.push(d),d=nt,p=nt,lt++,34===t.charCodeAt(nt)?(y='"',nt++):(y=a,0===lt&&pt(c)),lt--,y===a?p=void 0:(nt=p,p=a),p!==a?(t.length>nt?(y=t.charAt(nt),nt++):(y=a,0===lt&&pt(J)),y!==a?d=p=[p,y]:(nt=d,d=a)):(nt=d,d=a);(f=h!==a?t.substring(f,nt):h)!==a?(34===t.charCodeAt(nt)?(h='"',nt++):(h=a,0===lt&&pt(c)),h===a&&(h=nt,(d=xt())!==a&&(at=h,d=""),h=d),h!==a?(at=s,l=L(0,0,l,u,f,h),s=l):(nt=s,s=a)):(nt=s,s=a)}else nt=s,s=a;else nt=s,s=a;if(s===a){if(s=nt,61===t.charCodeAt(nt)?(l="=",nt++):(l=a,0===lt&&pt(_)),l!==a)if(39===t.charCodeAt(nt)?(u="'",nt++):(u=a,0===lt&&pt(m)),u!==a){for(f=nt,h=[],d=nt,p=nt,lt++,39===t.charCodeAt(nt)?(y="'",nt++):(y=a,0===lt&&pt(m)),lt--,y===a?p=void 0:(nt=p,p=a),p!==a?(t.length>nt?(y=t.charAt(nt),nt++):(y=a,0===lt&&pt(J)),y!==a?d=p=[p,y]:(nt=d,d=a)):(nt=d,d=a);d!==a;)h.push(d),d=nt,p=nt,lt++,39===t.charCodeAt(nt)?(y="'",nt++):(y=a,0===lt&&pt(m)),lt--,y===a?p=void 0:(nt=p,p=a),p!==a?(t.length>nt?(y=t.charAt(nt),nt++):(y=a,0===lt&&pt(J)),y!==a?d=p=[p,y]:(nt=d,d=a)):(nt=d,d=a);(f=h!==a?t.substring(f,nt):h)!==a?(39===t.charCodeAt(nt)?(h="'",nt++):(h=a,0===lt&&pt(m)),h===a&&(h=nt,(d=xt())!==a&&(at=h,d=""),h=d),h!==a?(at=s,l=L(0,0,l,u,f,h),s=l):(nt=s,s=a)):(nt=s,s=a)}else nt=s,s=a;else nt=s,s=a;if(s===a){if(s=nt,61===t.charCodeAt(nt)?(l="=",nt++):(l=a,0===lt&&pt(_)),l!==a){for(u=nt,f=[],h=nt,d=nt,lt++,Y.test(t.charAt(nt))?(p=t.charAt(nt),nt++):(p=a,0===lt&&pt(B)),lt--,p===a?d=void 0:(nt=d,d=a),d!==a?(t.length>nt?(p=t.charAt(nt),nt++):(p=a,0===lt&&pt(J)),p!==a?h=d=[d,p]:(nt=h,h=a)):(nt=h,h=a);h!==a;)f.push(h),h=nt,d=nt,lt++,Y.test(t.charAt(nt))?(p=t.charAt(nt),nt++):(p=a,0===lt&&pt(B)),lt--,p===a?d=void 0:(nt=d,d=a),d!==a?(t.length>nt?(p=t.charAt(nt),nt++):(p=a,0===lt&&pt(J)),p!==a?h=d=[d,p]:(nt=h,h=a)):(nt=h,h=a);(u=f!==a?t.substring(u,nt):f)!==a?(at=s,l=G(0,0,l,u),s=l):(nt=s,s=a)}else nt=s,s=a;s===a&&(s=nt,(l="")!==a&&(at=s,l=["","","",""]),s=l)}}s!==a?(at=i,o=K(0,o,s),i=o):(nt=i,i=a)}else nt=i,i=a;i===a&&(i=nt,(o=_t())!==a&&(at=i,o=Q(0,o)),(i=o)===a&&(i=nt,o=nt,s=nt,l=nt,lt++,41===t.charCodeAt(nt)?(u=")",nt++):(u=a,0===lt&&pt(g)),lt--,u===a?l=void 0:(nt=l,l=a),l!==a?(u=nt,lt++,f=At(),lt--,f===a?u=void 0:(nt=u,u=a),u!==a?(t.length>nt?(f=t.charAt(nt),nt++):(f=a,0===lt&&pt(J)),f!==a?s=l=[l,u,f]:(nt=s,s=a)):(nt=s,s=a)):(nt=s,s=a),(o=s!==a?t.substring(o,nt):s)!==a&&(at=i,o=V(0,o)),i=o))}n!==a?(41===t.charCodeAt(nt)?(i=")",nt++):(i=a,0===lt&&pt(g)),i===a&&(i=nt,o=nt,lt++,s=At(),lt--,s!==a?(nt=o,o=void 0):o=a,o!==a&&(at=i,o=""),i=o),i!==a?(at=e,e=r={_type:"parenthesis",left:r,content:n,right:i}):(nt=e,e=a)):(nt=e,e=a)}else nt=e,e=a;e===a&&(e=nt,46===t.charCodeAt(nt)?(r=".",nt++):(r=a,0===lt&&pt(W)),r===a&&(r=""),r!==a&&(at=e,r={_type:"separator",separator:r}),e=r);return e}())!==a&&(o=yt())!==a&&(s=function(){var t,e;t=nt,(e=At())!==a&&(at=t,r=e,kt.pop(),e=r);var r;return t=e}())!==a?(at=e,r={type:"element",lbm:r,name:n,attributes:i,children:o,rbm:s,location:ut()},e=r):(nt=e,e=a);return e}())===a&&(e=function(){var e,r,n,i,o;e=nt,(r=function(){var e,r,n,i;e=nt,96===t.charCodeAt(nt)?(r="`",nt++):(r=a,0===lt&&pt(Z));if(r!==a){for(n=[],60===t.charCodeAt(nt)?(i="<",nt++):(i=a,0===lt&&pt(l));i!==a;)n.push(i),60===t.charCodeAt(nt)?(i="<",nt++):(i=a,0===lt&&pt(l));n!==a?(at=e,o=r,wt=(s=n).length+1,r=o+s.join(""),e=r):(nt=e,e=a)}else nt=e,e=a;var o,s;return e}())!==a&&(n=function(){var e;46===t.charCodeAt(nt)?(e=".",nt++):(e=a,0===lt&&pt(W));e===a&&(e="");return e}())!==a&&(i=function(){var e,r,n,i,o;e=nt,r=[],n=nt,i=nt,lt++,o=Ct(),lt--,o===a?i=void 0:(nt=i,i=a);i!==a?(t.length>nt?(o=t.charAt(nt),nt++):(o=a,0===lt&&pt(J)),o!==a?(at=n,n=i=o):(nt=n,n=a)):(nt=n,n=a);for(;n!==a;)r.push(n),n=nt,i=nt,lt++,o=Ct(),lt--,o===a?i=void 0:(nt=i,i=a),i!==a?(t.length>nt?(o=t.charAt(nt),nt++):(o=a,0===lt&&pt(J)),o!==a?(at=n,n=i=o):(nt=n,n=a)):(nt=n,n=a);r!==a&&(at=e,r=tt(r));return e=r}())!==a&&(o=Ct())!==a?(at=e,r={type:"verbatim",lvm:r,separator:n,child:i,rvm:o,location:ut()},e=r):(nt=e,e=a);return e}())===a&&(e=function(){var e,r,n,i,o,s,l;e=nt,r=[],n=nt,i=nt,lt++,o=bt(),lt--,o===a?i=void 0:(nt=i,i=a);i!==a?(o=nt,lt++,s=At(),lt--,s===a?o=void 0:(nt=o,o=a),o!==a?(s=nt,lt++,96===t.charCodeAt(nt)?(l="`",nt++):(l=a,0===lt&&pt(Z)),lt--,l===a?s=void 0:(nt=s,s=a),s!==a?(t.length>nt?(l=t.charAt(nt),nt++):(l=a,0===lt&&pt(J)),l!==a?(at=n,n=i=l):(nt=n,n=a)):(nt=n,n=a)):(nt=n,n=a)):(nt=n,n=a);if(n!==a)for(;n!==a;)r.push(n),n=nt,i=nt,lt++,o=bt(),lt--,o===a?i=void 0:(nt=i,i=a),i!==a?(o=nt,lt++,s=At(),lt--,s===a?o=void 0:(nt=o,o=a),o!==a?(s=nt,lt++,96===t.charCodeAt(nt)?(l="`",nt++):(l=a,0===lt&&pt(Z)),lt--,l===a?s=void 0:(nt=s,s=a),s!==a?(t.length>nt?(l=t.charAt(nt),nt++):(l=a,0===lt&&pt(J)),l!==a?(at=n,n=i=l):(nt=n,n=a)):(nt=n,n=a)):(nt=n,n=a)):(nt=n,n=a);else r=a;r!==a&&(at=e,r=tt(r));return e=r}()),e}function bt(){var e,r,n,i,o,u;if(e=nt,91===t.charCodeAt(nt)?(r="[",nt++):(r=a,0===lt&&pt(s)),r!==a){for(n=nt,i=[],60===t.charCodeAt(nt)?(o="<",nt++):(o=a,0===lt&&pt(l));o!==a;)i.push(o),60===t.charCodeAt(nt)?(o="<",nt++):(o=a,0===lt&&pt(l));(n=i!==a?t.substring(n,nt):i)!==a?(at=nt,u=n,(i=(i=(kt[kt.length-1]||0)<=u.length+1)?void 0:a)!==a?(at=e,e=r=function(t,e){return t+e}(r,n)):(nt=e,e=a)):(nt=e,e=a)}else nt=e,e=a;return e}function At(){var e,r,n,i,o;for(e=nt,r=nt,n=[],62===t.charCodeAt(nt)?(i=">",nt++):(i=a,0===lt&&pt(w));i!==a;)n.push(i),62===t.charCodeAt(nt)?(i=">",nt++):(i=a,0===lt&&pt(w));return(r=n!==a?t.substring(r,nt):n)!==a?(93===t.charCodeAt(nt)?(n="]",nt++):(n=a,0===lt&&pt(X)),n!==a?(at=nt,o=r,(i=(i=(kt[kt.length-1]||0)==o.length+1)?void 0:a)!==a?(at=e,e=r=function(t,e){return t+e}(r,n)):(nt=e,e=a)):(nt=e,e=a)):(nt=e,e=a),e===a&&(e=nt,(r=xt())!==a&&(at=e,r=""),e=r),e}function xt(){var e,r;return e=nt,lt++,t.length>nt?(r=t.charAt(nt),nt++):(r=a,0===lt&&pt(J)),lt--,r===a?e=void 0:(nt=e,e=a),e}function Ct(){var e,r,n;for(e=nt,r=[],62===t.charCodeAt(nt)?(n=">",nt++):(n=a,0===lt&&pt(w));n!==a;)r.push(n),62===t.charCodeAt(nt)?(n=">",nt++):(n=a,0===lt&&pt(w));return r!==a?(96===t.charCodeAt(nt)?(n="`",nt++):(n=a,0===lt&&pt(Z)),n!==a?(at=nt,(wt==r.length+1?void 0:a)!==a?(at=e,e=r=function(t,e){return t.join("")+e}(r,n)):(nt=e,e=a)):(nt=e,e=a)):(nt=e,e=a),e===a&&(e=nt,(r=xt())!==a&&(at=e,r=""),e=r),e}function _t(){var e,r,n;if(e=nt,r=[],et.test(t.charAt(nt))?(n=t.charAt(nt),nt++):(n=a,0===lt&&pt(rt)),n!==a)for(;n!==a;)r.push(n),et.test(t.charAt(nt))?(n=t.charAt(nt),nt++):(n=a,0===lt&&pt(rt));else r=a;return e=r!==a?t.substring(e,nt):r}var wt,kt=[];if((r=o())!==a&&nt===t.length)return r;throw r!==a&&nt<t.length&&pt({type:"end"}),mt(st,ot<t.length?t.charAt(ot):null,ot<t.length?dt(ot,ot+1):dt(ot,ot))}}},function(t,e,r){"use strict";var n=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const a=n(r(12)),i=n(r(7)),o=n(r(2)),s=n(r(1)),l=n(r(0)),u=n(r(3)),c=n(r(6)),f=n(r(5));var h=new s.default({name:"[root]",display:"container-block",render:t=>t.html(t.innerHtml)});e.default={ast2nt:function(t,e){e||(e={}),e.tags||(e.tags={});var r=i.default.tags(a.default,e.tags);return function t(n){if("root"==n.type)return h.instantiate({code:n.code,attributes:[],children:n.children.map(t),options:e});if("text"==n.type)return new c.default(n.text);if("error"==n.type)return new u.default({message:"Parser error",code:n.text});if("element"==n.type){if(n.name in r&&r[n.name]){if(r[n.name].split){var a=(e,r)=>{if(0==r.length)return e.map(t);var n,i=r[r.length-1],o=[];(e=e.map(t=>"element"!=t.type||t.name!=i||t.children.length?t:{type:"delimiter"})).length&&"text"==e[0].type&&!e[0].text.trim()&&(e=e.slice(1)),e.length&&"delimiter"==e[0].type||e.unshift({type:"delimiter"});for(var s=0;s<e.length;s++)"delimiter"==e[s].type?(n&&o.push(n),n=[]):n.push(e[s]);return o.push(n),o.map(t=>a(t,r.slice(0,-1)))};return r[n.name].instantiate({code:n.code,attributes:n.attributes,children:a(n.children,r[n.name].split),options:e})}return r[n.name].instantiate({code:n.code,attributes:n.attributes,children:n.children.map(t),options:e})}return new u.default({message:n.name?`Undefined tag name [${n.name}]`:"No tag name",code:n.code})}throw TypeError(n.type)}(t.root)},Node:l.default,TextNode:c.default,HtmlNode:f.default,ErrorNode:u.default,ElementClass:s.default,Element:o.default}},function(t,e,r){"use strict";var n=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const a=n(r(1));var i={};function o(t){return t=t.trim(),/^#/.test(t)?!!/^#[^\s]*$/.test(t)&&t:/^(\/|\.\/|\.\.\/)/.test(t)?!!/^(\/|\.\/|\.\.\/)[^\s]*$/.test(t)&&t:(/^(http:\/\/|https:\/\/|ftp:\/\/)/.test(t)||(t="http://"+t),!!/^(http:\/\/|https:\/\/|ftp:\/\/)[a-z0-9]+(-+[a-z0-9]+)*(\.[a-z0-9]+(-+[a-z0-9]+)*)+\.?(:[0-9]{1,5})?(\/[^\s]*)?$/.test(t)&&t)}i.comment=new a.default({name:"comment",display:"inline",render:t=>t.text("")}),i.entity=new a.default({name:"entity",display:"inline",render:t=>t.innerIsText?/^([a-z]{1,50}|#[0-9]{1,10}|#x[0-9a-f]{1,10})$/i.test(t.innerText)?t.html(`&${t.innerText};`):t.error("Invalid value"):t.error("Non-text input")}),["b","code","i","u","sup","sub"].forEach(t=>i[t]=new a.default({name:t,display:"inline",render:e=>e.html(`<${t}>${e.innerHtml}</${t}>`)})),["h1","h2","h3","h4","h5","h6","p"].forEach(t=>i[t]=new a.default({name:t,display:"leaf-block",render:e=>e.html(`<${t}>${e.innerHtml}</${t}>`)})),i.blockquote=new a.default({name:"blockquote",display:"container-block",render:t=>{var e=t.getAttribute("type");return["info","warn"].includes(e)?t.html(`<blockquote class="m42kup-bq-${e}">${t.innerHtml}</blockquote>`):t.html(`<blockquote>${t.innerHtml}</blockquote>`)}}),["br"].forEach(t=>i[t]=new a.default({name:t,display:"inline",render:e=>e.html(`<${t}>${e.innerHtml}`)})),["hr"].forEach(t=>i[t]=new a.default({name:t,display:"leaf-block",render:e=>e.html(`<${t}>${e.innerHtml}`)})),["ul","ol"].forEach(t=>{i[t]=new a.default({name:t,display:"container-block",split:"*",render:e=>e.html(`<${t}>`+e.innerHtml.map(t=>`<li>${t}</li>`).join("")+`</${t}>`)})}),i.table=new a.default({name:"table",display:"container-block",split:["*","**"],render:t=>{var e=t.innerHtml.map(t=>t.length).reduce((t,e)=>t<e?e:t);return t.html("<table>"+t.innerHtml.map(t=>`<tr>${t.concat(Array(e-t.length).fill("")).map(t=>`<td>${t}</td>`).join("")}</tr>`).join("")+"</table>")}}),i.blockcode=new a.default({name:"blockcode",display:"leaf-block",render:t=>{var e=t.innerHtml.replace(/(^[ \t]*(\r\n|\r|\n))|((\r\n|\r|\n)[ \t]*$)/g,"");return t.html(`<pre><code>${e}\n</code></pre>`)}}),i.bi=new a.default({name:"bi",display:"inline",render:t=>t.html(`<i><b>${t.innerHtml}</b></i>`)}),i.link=new a.default({name:"link",display:"inline",render:t=>{var e=t.getAttribute("href");if(null==e){if(!t.innerIsText)return t.error("Non-text input");let e=o(t.innerText);if(!e)return t.error("Invalid URL");let r=t.escapeHtml(e);return t.html(`<a href="${r}" title="${r}">${r}</a>`)}{let r=o(e);if(!r)return t.error("Invalid URL");let n=t.escapeHtml(r);return t.html(`<a href="${n}" title="${n}">${t.innerHtml}</a>`)}}}),i.img=new a.default({name:"img",display:"leaf-block",render:t=>{if(!t.innerIsText)return t.error("Non-text input");var e=o(t.innerText);if(!e)return t.error("Invalid URL");var r=t.escapeHtml(e);return t.html(`<img src="${r}">`)}}),["squote","dquote"].forEach(t=>i[t]=new a.default({name:t,display:"inline",render:e=>{var r={squote:{normal:["‘","’"],angle:["〈","〉"],corner:["「","」"]},dquote:{normal:["“","”"],angle:["《","》"],corner:["『","』"]}},n=e.getAttribute("type");return["angle","corner"].includes(n)||(n="normal"),e.html(`${r[t][n][0]}${e.innerHtml}${r[t][n][1]}`)}})),i.highlight=new a.default({name:"highlight",display:"leaf-block",render:(t,e)=>{if(!e.hljs)return t.error("Element not implemented (options.highlight not given)");if(!t.innerIsText)return t.error("Non-text input");var r,n=["apache","bash","coffeescript","cpp","cs","css","diff","http","ini","java","javascript","json","makefile","xml","markdown","nginx","objectivec","perl","php","python","ruby","sql"],a=t.innerText.replace(/(^[ \t]*(\r\n|\r|\n))|((\r\n|\r|\n)[ \t]*$)/g,"");if(n.includes(t.getAttribute("lang"))){var i=t.getAttribute("lang");r=e.hljs.highlight(i,a).value}else r=e.hljs.highlightAuto(a,n).value;return t.html(`<pre class="hljs"><code>${r}\n</code></pre>`)}}),i.math=new a.default({name:"math",display:"inline",render:(t,e)=>{if(!e.katex)return t.error("Element not implemented (options.katex not given)");if(!t.innerIsText)return t.error("Non-text input");var r=e.katex.renderToString(t.innerText,{throwOnError:!1,displayMode:!1,strict:"error"});return t.html(r)}}),i.displaymath=new a.default({name:"displaymath",display:"leaf-block",render:(t,e)=>{if(!e.katex)return t.error("Element not implemented (options.katex not given)");if(!t.innerIsText)return t.error("Non-text input");var r=e.katex.renderToString(t.innerText,{throwOnError:!1,displayMode:!0,strict:"error"});return t.html(r)}});var s={'"':"dquote",$:"math",$$:"displaymath","%":"comment","&":"entity","'":"squote","*":"i","**":"b","***":"bi",";":"code",";;":"blockcode",";;;":"highlight","=":"h1","==":"h2","===":"h3","====":"h4","=====":"h5","======":"h6",">":"blockquote","\\":"br","^":"sup",_:"sub","~":"link","~~":"img"};for(var l in s){if(!i[s[l]])throw TypeError("aliasing failed");i[l]=i[s[l]]}e.default=i},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});function n(t){return`<span class="m42hl-${t.type}">${t.html||(e=t.text,(e+"").replace(/[&<>"']/g,t=>({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"}[t])))}</span>`;var e}e.default={pt2hl:function(t){return function t(e){for(var r="",a=0;a<e.length;a++)switch(e[a].type){case"text":r+=n({type:"tx",text:e[a].text});break;case"element":var i=n({type:"lbm",text:e[a].lbm})+n({type:"tn",text:e[a].name})+(t=>{switch(t._type){case"parenthesis":return n({type:"lpm",text:t.left})+t.content.map(t=>{switch(t._type){case"attribute":return n({type:"pk",text:t.attribute[0]})+n({type:"eq",text:t.attribute[1]})+n({type:"lqm",text:t.attribute[2]})+n({type:"pv",text:t.attribute[3]})+n({type:"rqm",text:t.attribute[4]});case"whitespace":return n({type:"tx",text:t.whitespace});case"error":return n({type:"err",text:t.error});default:throw Error("Unknown type")}}).join("")+n({type:"rpm",text:t.right});case"separator":return n({type:"sp",text:t.separator});default:throw Error("Unknown type")}})(e[a].attributes)+t(e[a].children)+n({type:"rbm",text:e[a].rbm});r+=n({type:"elem",html:i});break;case"verbatim":var o=n({type:"lvm",text:e[a].lvm+e[a].separator})+n({type:"tx",text:e[a].child.text})+n({type:"rvm",text:e[a].rvm});r+=n({type:"verb",html:o});break;default:throw new TypeError("Unknown type: "+e[a].type)}return r}(t.root.children)}}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=4,a=5;e.default=function(t){function e(t,e){if((e.levels[e.levels.length-1]||0)<0){var r=-e.levels[e.levels.length-1],i=">".repeat(r-1)+"`";return t.skipTo(i)?(t.match(i),e.levels.pop()):t.skipToEnd(),"comment"}var o=t.peek();if(![n,a].includes(e.status)&&[">","]"].includes(o)&&(u=e.levels[e.levels.length-1]||0)>0){var s=">".repeat(u-1)+"]";if(t.match(s))return e.levels.pop(),e.status=0,"tag"}if(0!=e.status){if(t.match(")"))return e.status=0,"tag";if(1==e.status)return t.match(/^[a-z0-9-]+/)?(e.status=2,"attribute"):t.match(/^[ \t\n\r]+/)?null:(t.next(),"error");if(2==e.status)return t.match("=")?(e.status=3,null):(e.status=1,null);if(3==e.status)return t.match('"')?(e.status=n,"string"):t.match("'")?(e.status=a,"string"):(t.match(/^[^'"()\[\] \t\n\r]*/),e.status=1,"string");if(e.status==n)return t.skipTo('"')?(t.match('"'),e.status=1):t.skipToEnd(),"string";if(e.status==a)return t.skipTo("'")?(t.match("'"),e.status=1):t.skipToEnd(),"string"}if("`"==o){t.next();for(var l=1;o=t.next();){if("<"!=o){t.backUp(1);break}l++}return e.levels.push(-l),"comment"}if("["==o){t.next();for(l=1;o=t.next();){if("<"!=o){t.backUp(1);break}l++}if(l<(e.levels[e.levels.length-1]||0))return null;if(t.match(/^(?:\!+|\"+|\#+|\$+|\%+|\&+|\'+|\)+|\*+|\++|\,+|\-+|\/+|\;+|\=+|\>+|\?+|\@+|\\+|\^+|\_+|\{+|\|+|\}+|\~+|[a-z][a-z0-9]*(?:\:[a-z][a-z0-9]*)*|)/),t.match("("))e.status=1;else{t.match(/^(?:[.]|)/i)}return e.levels.push(l),"tag"}if(">"==o||"]"==o){var u;if((u=e.levels[e.levels.length-1]||0)<=0)return t.next(),null;s=">".repeat(u-1)+"]";return t.match(s)?(e.levels.pop(),"tag"):(t.next(),null)}t.match(/^[^\[\]`>]+/)}t.defineMode("m42kup",(t,r)=>({startState:t=>({levels:[],status:0}),token:e}))}}])}));
//# sourceMappingURL=m42kup.min.js.map